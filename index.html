<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TaijiFlow AI</title>

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="favicon.png" />

    <!-- Stylesheets -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />

    <!-- Scripts (‡πÉ‡∏ä‡πâ defer ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÇ‡∏´‡∏•‡∏î‡∏û‡∏£‡πâ‡∏≠‡∏° HTML ‡πÅ‡∏ï‡πà‡∏£‡∏±‡∏ô‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á) -->
    <script
      src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"
      crossorigin="anonymous"
      defer
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js"
      crossorigin="anonymous"
      defer
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/@mediapipe/pose/pose.js"
      crossorigin="anonymous"
      defer
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision/vision_bundle.js"
      crossorigin="anonymous"
      defer
    ></script>

    <!-- App Modules -->
    <script src="calibration_manager.js" defer></script>
    <script src="heuristics_engine.js" defer></script>
    <script src="drawing_manager.js" defer></script>
    <script src="data_exporter.js" defer></script>
    <script src="audio_manager.js" defer></script>
    <script src="scoring_manager.js" defer></script>
    <script src="ui_manager.js" defer></script>
    <script src="script.js" defer></script>
  </head>
  <body
    class="h-screen flex flex-col items-center justify-center p-4 bg-f3f4f6"
  >
    <!-- Header & Toggle Buttons -->
    <div class="w-full max-w-6xl flex justify-between items-center mb-4">
      <h1
        id="app-title"
        class="text-3xl font-bold text-gray-800 dark:text-white"
      >
        ‚òØÔ∏è TaijiFlow AI: ‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏ù‡∏∂‡∏Å‡∏°‡∏ß‡∏¢‡πÑ‡∏ó‡πâ‡πÄ‡∏Å‡πä‡∏Å - ‡∏ó‡πà‡∏≤‡∏°‡πâ‡∏ß‡∏ô‡πÑ‡∏´‡∏°
      </h1>

      <div class="flex gap-2">
        <button
          id="audio-btn"
          class="px-3 py-1 bg-green-600 text-white border border-green-700 rounded hover:bg-green-700 text-sm transition-colors"
          title="‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏û‡∏π‡∏î"
        >
          üîä
        </button>
        <button
          id="lang-btn"
          class="px-3 py-1 bg-white border border-gray-300 rounded hover:bg-gray-100 font-bold text-sm transition-colors"
        >
          üáπüá≠ TH / üá∫üá∏ EN
        </button>
        <button
          id="theme-btn"
          class="px-3 py-1 bg-gray-800 text-white border border-gray-600 rounded hover:bg-gray-700 text-sm transition-colors"
        >
          üåô / ‚òÄÔ∏è
        </button>
      </div>
    </div>

    <div class="flex flex-col md:flex-row gap-6 items-start w-full max-w-6xl">
      <!-- Video Canvas Container -->
      <div class="relative flex-grow group w-full md:w-auto">
        <video
          id="input_video"
          style="display: none"
          autoplay
          playsinline
        ></video>
        <canvas
          id="output_canvas"
          width="1280"
          height="720"
          class="w-full bg-black rounded-lg"
        ></canvas>

        <!-- Loading Overlay -->
        <div
          id="loading-overlay"
          class="absolute inset-0 flex items-center justify-center bg-black bg-opacity-80 text-white text-xl z-20 hidden rounded-lg"
        >
          <div class="flex flex-col items-center">
            <svg
              class="animate-spin h-10 w-10 text-white mb-3"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
            >
              <circle
                class="opacity-25"
                cx="12"
                cy="12"
                r="10"
                stroke="currentColor"
                stroke-width="4"
              ></circle>
              <path
                class="opacity-75"
                fill="currentColor"
                d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
              ></path>
            </svg>
            <span id="loading-text">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏°‡πÄ‡∏î‡∏• AI...</span>
          </div>
        </div>

        <!-- Start Overlay -->
        <div
          id="start-overlay"
          class="absolute inset-0 flex flex-col items-center justify-center bg-black bg-opacity-70 z-10 rounded-lg transition-opacity duration-300"
        >
          <h2
            id="overlay-title"
            class="text-white text-2xl font-bold mb-6 drop-shadow-md"
          >
            ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ù‡∏∂‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á?
          </h2>
          <button
            id="big-calibrate-btn"
            class="pulse-btn bg-purple-600 hover:bg-purple-700 text-white text-xl font-bold py-4 px-10 rounded-full shadow-lg transform transition hover:scale-105 flex items-center gap-3"
          >
            <span id="big-calibrate-btn-text"
              >üìè ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô (Calibrate)</span
            >
          </button>
          <p id="overlay-desc" class="text-gray-300 mt-4 text-sm">
            *‡∏Å‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ß‡∏±‡∏î‡∏ï‡∏±‡∏ß‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å
          </p>
        </div>
      </div>

      <!-- Controls Panel -->
      <div
        id="main-card"
        class="w-full md:w-80 flex flex-col gap-4 bg-white p-6 rounded-lg shadow-md border border-gray-200 transition-colors duration-300"
      >
        <!-- Select Exercise -->
        <div>
          <label
            id="label-exercise"
            class="block text-sm font-bold text-gray-700 mb-2"
            >‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡πà‡∏≤‡∏ù‡∏∂‡∏Å:</label
          >
          <select
            id="exercise-select"
            class="w-full p-2 border rounded-md bg-gray-50 text-gray-900 focus:ring-2 focus:ring-blue-500 outline-none transition-colors"
            title="‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡πà‡∏≤‡∏ù‡∏∂‡∏Å"
          >
            <option value="rh_cw">‡∏°‡∏∑‡∏≠‡∏Ç‡∏ß‡∏≤ - ‡∏ï‡∏≤‡∏°‡πÄ‡∏Ç‡πá‡∏°</option>
            <option value="rh_ccw">‡∏°‡∏∑‡∏≠‡∏Ç‡∏ß‡∏≤ - ‡∏ó‡∏ß‡∏ô‡πÄ‡∏Ç‡πá‡∏°</option>
            <option value="lh_cw">‡∏°‡∏∑‡∏≠‡∏ã‡πâ‡∏≤‡∏¢ - ‡∏ï‡∏≤‡∏°‡πÄ‡∏Ç‡πá‡∏°</option>
            <option value="lh_ccw">‡∏°‡∏∑‡∏≠‡∏ã‡πâ‡∏≤‡∏¢ - ‡∏ó‡∏ß‡∏ô‡πÄ‡∏Ç‡πá‡∏°</option>
          </select>
        </div>

        <!-- Select Level -->
        <div>
          <label
            id="label-level"
            class="block text-sm font-bold text-gray-700 mb-2"
            >‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö:</label
          >
          <div class="flex flex-col gap-2" id="level-buttons">
            <button
              id="level1-btn"
              data-level="L1"
              class="level-btn active w-full py-2 px-4 rounded bg-blue-600 text-white font-bold transition hover:bg-blue-700 shadow-sm"
            >
              Level 1: ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πà‡∏á
            </button>
            <button
              id="level2-btn"
              data-level="L2"
              class="level-btn w-full py-2 px-4 rounded bg-gray-100 text-gray-600 font-medium transition hover:bg-gray-200"
            >
              Level 2: ‡∏ó‡πà‡∏≤‡∏¢‡∏∑‡∏ô
            </button>
            <button
              id="level3-btn"
              data-level="L3"
              class="level-btn w-full py-2 px-4 rounded bg-gray-100 text-gray-600 font-medium transition hover:bg-gray-200"
            >
              Level 3: ‡∏ó‡πà‡∏≤‡∏¢‡∏∑‡∏ô‡∏¢‡πà‡∏≠
            </button>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="flex flex-col gap-2 mt-4 pt-4 border-t border-gray-200">
          <div class="flex gap-2">
            <button
              id="small-calibrate-btn"
              class="flex-grow py-2 bg-purple-100 text-purple-700 font-bold rounded border border-purple-200 hover:bg-purple-200 transition"
            >
              üìè ‡∏ß‡∏±‡∏î‡∏ï‡∏±‡∏ß‡πÉ‡∏´‡∏°‡πà
            </button>
            <button
              id="cancel-calib-btn"
              class="hidden py-2 px-4 bg-red-500 text-white font-bold rounded shadow hover:bg-red-600 transition"
            >
              ‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
            </button>
          </div>

          <div class="flex gap-2">
            <button
              id="fullscreen-btn"
              class="flex-1 py-2 bg-gray-700 text-white rounded hover:bg-gray-800 transition"
            >
              ‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠ (F)
            </button>
            <button
              id="record-btn"
              class="flex-1 py-2 bg-red-100 text-red-600 border border-red-200 rounded hover:bg-red-200 transition font-bold"
            >
              ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å (R)
            </button>
          </div>
        </div>

        <!-- Instructions -->
        <div
          class="mt-2 p-3 bg-blue-50 text-blue-800 text-xs rounded border border-blue-100 dark:bg-blue-900 dark:text-blue-100 dark:border-blue-800 transition-colors"
        >
          <strong id="instr-title">üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong>
          <ul class="list-disc list-inside mt-1 space-y-1">
            <li id="instr-1">‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö" ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°</li>
            <li id="instr-2">‡∏¢‡∏∑‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏ï‡∏±‡∏ß 2-3 ‡πÄ‡∏°‡∏ï‡∏£</li>
            <li id="instr-3">‡πÅ‡∏™‡∏á‡∏™‡∏ß‡πà‡∏≤‡∏á‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Notification Container -->
    <div
      id="notification-container"
      class="fixed top-5 right-5 z-50 flex flex-col items-end gap-3"
    >
      <!-- Notifications will be injected here by JavaScript -->
    </div>
  </body>
</html>
