<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1550px" preserveAspectRatio="none" style="width:1553px;height:1550px;" version="1.1" viewBox="0 0 1553 1550" width="1553px" zoomAndPan="magnify"><defs><filter height="300%" id="f1ecy08j79xg27" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[ed1d20ea533a2a0e7df5ba3c35e56ced]
cluster Controllers--><rect fill="#E3F2FD" filter="url(#f1ecy08j79xg27)" height="371" style="stroke:#000000;stroke-width:1.5;" width="786.5" x="24.5" y="680"/><text fill="#000000" font-family="sarabun" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="76" x="379.75" y="696.952">«Controller»</text><text fill="#000000" font-family="sarabun" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="73" x="381.25" y="715.152">Controllers</text><!--MD5=[1fc7141c6f48660c71a2006c6bf2683f]
cluster Core Managers--><rect fill="#FFF3E0" filter="url(#f1ecy08j79xg27)" height="269" style="stroke:#000000;stroke-width:1.5;" width="626" x="915" y="1231"/><text fill="#000000" font-family="sarabun" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="42" x="1207" y="1247.952">«Core»</text><text fill="#000000" font-family="sarabun" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="95" x="1180.5" y="1266.152">Core Managers</text><!--MD5=[af552435e54b04649ea7481a5d22641b]
cluster Display Managers--><rect fill="#E0F7FA" filter="url(#f1ecy08j79xg27)" height="745" style="stroke:#000000;stroke-width:1.5;" width="289" x="858" y="462"/><text fill="#000000" font-family="sarabun" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="58" x="973.5" y="478.952">«Display»</text><text fill="#000000" font-family="sarabun" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="109" x="948" y="497.152">Display Managers</text><!--MD5=[7ac1916149c3369d001f628ff410a677]
cluster UI & Feedback--><rect fill="#E8F5E9" filter="url(#f1ecy08j79xg27)" height="618" style="stroke:#000000;stroke-width:1.5;" width="513.5" x="320.5" y="7"/><text fill="#000000" font-family="sarabun" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="27" x="563.75" y="23.952">«UI»</text><text fill="#000000" font-family="sarabun" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="91" x="531.75" y="42.152">UI &amp; Feedback</text><!--MD5=[0b7db6fcd588f8499928e45a474751dc]
cluster Utilities--><rect fill="#F3E5F5" filter="url(#f1ecy08j79xg27)" height="463" style="stroke:#000000;stroke-width:1.5;" width="315" x="294" y="1075"/><text fill="#000000" font-family="sarabun" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="49" x="427" y="1091.952">«Utility»</text><text fill="#000000" font-family="sarabun" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="51" x="426" y="1110.152">Utilities</text><!--MD5=[d0d7b0900e371541ba11cbff692d2bc7]
class Script--><rect codeLine="35" fill="#FFFFFF" filter="url(#f1ecy08j79xg27)" height="171.6" id="Script" style="stroke:#000000;stroke-width:1.5;" width="184" x="50" y="863.2"/><ellipse cx="117.25" cy="883.8" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M119.7231,889.9431 Q119.1421,890.2419 118.5029,890.3913 Q117.8638,890.5407 117.1582,890.5407 Q114.6514,890.5407 113.3315,888.8889 Q112.0117,887.237 112.0117,884.1159 Q112.0117,880.9865 113.3315,879.3347 Q114.6514,877.6828 117.1582,877.6828 Q117.8638,877.6828 118.5112,877.8322 Q119.1587,877.9816 119.7231,878.2805 L119.7231,881.0031 Q119.0923,880.4221 118.4988,880.1523 Q117.9053,879.8825 117.2744,879.8825 Q115.9297,879.8825 115.2449,880.9492 Q114.5601,882.0158 114.5601,884.1159 Q114.5601,886.2077 115.2449,887.2744 Q115.9297,888.341 117.2744,888.341 Q117.9053,888.341 118.4988,888.0712 Q119.0923,887.8015 119.7231,887.2204 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="39" x="138.75" y="881.016">«Main»</text><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="41" x="137.75" y="896.616">script.js</text><line style="stroke:#000000;stroke-width:1.5;" x1="51" x2="233" y1="904.4" y2="904.4"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="58" y="912.4"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="120" x="70" y="920.148">isTrainingMode: boolean</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="58" y="926.7"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="158" x="70" y="934.448">currentPerformanceMode: string</text><line style="stroke:#000000;stroke-width:1.0;" x1="51" x2="233" y1="941" y2="941"/><ellipse cx="61" cy="952" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="91" x="70" y="956.748">startTrainingFlow()</text><ellipse cx="61" cy="966.3" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="101" x="70" y="971.048">endTrainingSession()</text><ellipse cx="61" cy="980.6" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="86" x="70" y="985.348">onResults(results)</text><ellipse cx="61" cy="994.9" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="99" x="70" y="999.648">loadReferenceData()</text><ellipse cx="61" cy="1009.2" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="137" x="70" y="1013.948">setPerformanceMode(mode)</text><ellipse cx="61" cy="1023.5" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="151" x="70" y="1028.248">selectPerformanceMode(mode)</text><!--MD5=[8efddad45aa6a4eb444717d204646b2a]
class KeyboardController--><rect codeLine="47" fill="#FFFFFF" filter="url(#f1ecy08j79xg27)" height="90.9" id="KeyboardController" style="stroke:#000000;stroke-width:1.5;" width="135" x="384" y="921.55"/><ellipse cx="399" cy="937.55" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M401.4731,943.6931 Q400.8921,943.9919 400.2529,944.1413 Q399.6138,944.2907 398.9082,944.2907 Q396.4014,944.2907 395.0815,942.6389 Q393.7617,940.987 393.7617,937.8659 Q393.7617,934.7365 395.0815,933.0847 Q396.4014,931.4328 398.9082,931.4328 Q399.6138,931.4328 400.2612,931.5822 Q400.9087,931.7316 401.4731,932.0305 L401.4731,934.7531 Q400.8423,934.1721 400.2488,933.9023 Q399.6553,933.6325 399.0244,933.6325 Q397.6797,933.6325 396.9949,934.6992 Q396.3101,935.7658 396.3101,937.8659 Q396.3101,939.9577 396.9949,941.0244 Q397.6797,942.091 399.0244,942.091 Q399.6553,942.091 400.2488,941.8212 Q400.8423,941.5515 401.4731,940.9704 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="103" x="413" y="942.566">KeyboardController</text><line style="stroke:#000000;stroke-width:1.5;" x1="385" x2="518" y1="953.55" y2="953.55"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="392" y="961.55"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="59" x="404" y="969.298">deps: object</text><line style="stroke:#000000;stroke-width:1.0;" x1="385" x2="518" y1="975.85" y2="975.85"/><ellipse cx="395" cy="986.85" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="109" x="404" y="991.598">handleKeydown(event)</text><ellipse cx="395" cy="1001.15" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="98" x="404" y="1005.898">showShortcutsHelp()</text><!--MD5=[8172fdb26fe0b4f66f8ce07666356cda]
class DisplayController--><rect codeLine="54" fill="#FFFFFF" filter="url(#f1ecy08j79xg27)" height="291.1" id="DisplayController" style="stroke:#000000;stroke-width:1.5;" width="170" x="625" y="743.45"/><ellipse cx="661.6" cy="759.45" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M664.0731,765.5931 Q663.4921,765.8919 662.8529,766.0413 Q662.2138,766.1907 661.5082,766.1907 Q659.0014,766.1907 657.6815,764.5389 Q656.3617,762.887 656.3617,759.7659 Q656.3617,756.6365 657.6815,754.9847 Q659.0014,753.3328 661.5082,753.3328 Q662.2138,753.3328 662.8612,753.4822 Q663.5087,753.6316 664.0731,753.9305 L664.0731,756.6531 Q663.4423,756.0721 662.8488,755.8023 Q662.2553,755.5325 661.6244,755.5325 Q660.2797,755.5325 659.5949,756.5992 Q658.9101,757.6658 658.9101,759.7659 Q658.9101,761.8577 659.5949,762.9244 Q660.2797,763.991 661.6244,763.991 Q662.2553,763.991 662.8488,763.7212 Q663.4423,763.4515 664.0731,762.8704 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="90" x="680.4" y="764.466">DisplayController</text><line style="stroke:#000000;stroke-width:1.5;" x1="626" x2="794" y1="775.45" y2="775.45"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="633" y="783.45"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="133" x="645" y="791.198">showGhostOverlay: boolean</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="633" y="797.75"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="91" x="645" y="805.498">showPath: boolean</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="633" y="812.05"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="111" x="645" y="819.798">showSkeleton: boolean</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="633" y="826.35"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="119" x="645" y="834.098">showSilhouette: boolean</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="633" y="840.65"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="91" x="645" y="848.398">showTrail: boolean</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="633" y="854.95"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="144" x="645" y="862.698">showBlurBackground: boolean</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="633" y="869.25"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="122" x="645" y="876.998">showSideBySide: boolean</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="633" y="883.55"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="142" x="645" y="891.298">showErrorHighlights: boolean</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="633" y="897.85"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="85" x="645" y="905.598">trailHistory: array</text><line style="stroke:#000000;stroke-width:1.0;" x1="626" x2="794" y1="912.15" y2="912.15"/><ellipse cx="636" cy="923.15" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="22" x="645" y="927.898">init()</text><ellipse cx="636" cy="937.45" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="108" x="645" y="942.198">toggleInstructor(show)</text><ellipse cx="636" cy="951.75" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="84" x="645" y="956.498">resetToDefaults()</text><ellipse cx="636" cy="966.05" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="87" x="645" y="970.798">addTrailPoint(x, y)</text><ellipse cx="636" cy="980.35" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="52" x="645" y="985.098">clearTrail()</text><ellipse cx="636" cy="994.65" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="52" x="645" y="999.398">clearTrail()</text><ellipse cx="636" cy="1008.95" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="142" x="645" y="1013.698">initBlurBackgroundCheckbox()</text><ellipse cx="636" cy="1023.25" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="141" x="645" y="1027.998">autoDisableHighCostEffects()</text><path d="M40.5,735.2 L40.5,812.8 L243.5,812.8 L243.5,745.2 L233.5,735.2 L40.5,735.2 " fill="#FBFB77" filter="url(#f1ecy08j79xg27)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M233.5,735.2 L233.5,745.2 L243.5,745.2 L233.5,735.2 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="137" x="46.5" y="754.084">จัดการ Application Flow</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="136" x="46.5" y="770.984">Script = Main Controller</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="182" x="46.5" y="787.884">Keyboard = 15 Shortcuts (เพิ่ม K)</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="166" x="46.5" y="804.784">Display = 7 Options (เพิ่ม Blur)</text><!--MD5=[acf674d2eee96cced2a8b22730b1989e]
class HeuristicsEngine--><rect codeLine="88" fill="#FFFFFF" filter="url(#f1ecy08j79xg27)" height="198.15" id="HeuristicsEngine" style="stroke:#000000;stroke-width:1.5;" width="177" x="1171" y="1285.93"/><ellipse cx="1211.65" cy="1301.93" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M1214.1231,1308.0731 Q1213.5421,1308.3719 1212.9029,1308.5213 Q1212.2638,1308.6707 1211.5582,1308.6707 Q1209.0514,1308.6707 1207.7315,1307.0189 Q1206.4117,1305.367 1206.4117,1302.2459 Q1206.4117,1299.1165 1207.7315,1297.4647 Q1209.0514,1295.8128 1211.5582,1295.8128 Q1212.2638,1295.8128 1212.9112,1295.9622 Q1213.5587,1296.1116 1214.1231,1296.4105 L1214.1231,1299.1331 Q1213.4923,1298.5521 1212.8988,1298.2823 Q1212.3053,1298.0125 1211.6744,1298.0125 Q1210.3297,1298.0125 1209.6449,1299.0792 Q1208.9601,1300.1458 1208.9601,1302.2459 Q1208.9601,1304.3377 1209.6449,1305.4044 Q1210.3297,1306.471 1211.6744,1306.471 Q1212.3053,1306.471 1212.8988,1306.2012 Q1213.4923,1305.9315 1214.1231,1305.3504 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="88" x="1231.35" y="1306.946">HeuristicsEngine</text><line style="stroke:#000000;stroke-width:1.5;" x1="1172" x2="1347" y1="1317.93" y2="1317.93"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1179" y="1325.93"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="66" x="1191" y="1333.678">config: object</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1179" y="1340.23"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="111" x="1191" y="1347.978">calibrationData: object</text><line style="stroke:#000000;stroke-width:1.0;" x1="1172" x2="1347" y1="1354.53" y2="1354.53"/><ellipse cx="1182" cy="1365.53" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="151" x="1191" y="1370.278">analyze(landmarks): Feedback[]</text><ellipse cx="1182" cy="1379.83" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="96" x="1191" y="1384.578">setCalibration(data)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1179" y="1391.13"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="85" x="1191" y="1398.878">checkPathShape()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1179" y="1405.43"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="96" x="1191" y="1413.178">checkElbowSinking()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1179" y="1419.73"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="82" x="1191" y="1427.478">checkContinuity()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1179" y="1434.03"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="82" x="1191" y="1441.778">checkContinuity()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1179" y="1448.33"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="94" x="1191" y="1456.078">checkArmRotation()</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:1.0,2.0;" x1="1172" x2="1225.5" y1="1469.78" y2="1469.78"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="68" x="1225.5" y="1473.878">+4 more rules</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:1.0,2.0;" x1="1293.5" x2="1347" y1="1469.78" y2="1469.78"/><!--MD5=[2695471b11f4afe9b2f935479e6afc73]
class CalibrationManager--><rect codeLine="102" fill="#FFFFFF" filter="url(#f1ecy08j79xg27)" height="176.7" id="CalibrationManager" style="stroke:#000000;stroke-width:1.5;" width="137" x="1388" y="1302.65"/><ellipse cx="1403.9" cy="1318.65" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M1406.3731,1324.7931 Q1405.7921,1325.0919 1405.1529,1325.2413 Q1404.5138,1325.3907 1403.8082,1325.3907 Q1401.3014,1325.3907 1399.9815,1323.7389 Q1398.6617,1322.087 1398.6617,1318.9659 Q1398.6617,1315.8365 1399.9815,1314.1847 Q1401.3014,1312.5328 1403.8082,1312.5328 Q1404.5138,1312.5328 1405.1612,1312.6822 Q1405.8087,1312.8316 1406.3731,1313.1305 L1406.3731,1315.8531 Q1405.7423,1315.2721 1405.1488,1315.0023 Q1404.5553,1314.7325 1403.9244,1314.7325 Q1402.5797,1314.7325 1401.8949,1315.7992 Q1401.2101,1316.8658 1401.2101,1318.9659 Q1401.2101,1321.0577 1401.8949,1322.1244 Q1402.5797,1323.191 1403.9244,1323.191 Q1404.5553,1323.191 1405.1488,1322.9212 Q1405.7423,1322.6515 1406.3731,1322.0704 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="103" x="1418.1" y="1323.666">CalibrationManager</text><line style="stroke:#000000;stroke-width:1.5;" x1="1389" x2="1524" y1="1334.65" y2="1334.65"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1396" y="1342.65"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="83" x="1408" y="1350.398">isActive: boolean</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1396" y="1356.95"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="111" x="1408" y="1364.698">calibrationData: object</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1396" y="1371.25"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="57" x="1408" y="1378.998">level: string</text><line style="stroke:#000000;stroke-width:1.0;" x1="1389" x2="1524" y1="1385.55" y2="1385.55"/><ellipse cx="1399" cy="1396.55" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="29" x="1408" y="1401.298">start()</text><ellipse cx="1399" cy="1410.85" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="27" x="1408" y="1415.598">stop()</text><ellipse cx="1399" cy="1425.15" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="37" x="1408" y="1429.898">cancel()</text><ellipse cx="1399" cy="1439.45" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="93" x="1408" y="1444.198">process(landmarks)</text><ellipse cx="1399" cy="1453.75" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="70" x="1408" y="1458.498">setLevel(level)</text><ellipse cx="1399" cy="1468.05" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="79" x="1408" y="1472.798">drawOverlay(ctx)</text><!--MD5=[49faa9a638d20fb09fbea4482760b511]
class ScoringManager--><rect codeLine="115" fill="#FFFFFF" filter="url(#f1ecy08j79xg27)" height="119.5" id="ScoringManager" style="stroke:#000000;stroke-width:1.5;" width="143" x="931" y="1325.25"/><ellipse cx="958.15" cy="1341.25" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M960.6231,1347.3931 Q960.0421,1347.6919 959.4029,1347.8413 Q958.7638,1347.9907 958.0582,1347.9907 Q955.5514,1347.9907 954.2315,1346.3389 Q952.9117,1344.687 952.9117,1341.5659 Q952.9117,1338.4365 954.2315,1336.7847 Q955.5514,1335.1328 958.0582,1335.1328 Q958.7638,1335.1328 959.4112,1335.2822 Q960.0587,1335.4316 960.6231,1335.7305 L960.6231,1338.4531 Q959.9923,1337.8721 959.3988,1337.6023 Q958.8053,1337.3325 958.1744,1337.3325 Q956.8297,1337.3325 956.1449,1338.3992 Q955.4601,1339.4658 955.4601,1341.5659 Q955.4601,1343.6577 956.1449,1344.7244 Q956.8297,1345.791 958.1744,1345.791 Q958.8053,1345.791 959.3988,1345.5212 Q959.9923,1345.2515 960.6231,1344.6704 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="84" x="974.85" y="1346.266">ScoringManager</text><line style="stroke:#000000;stroke-width:1.5;" x1="932" x2="1073" y1="1357.25" y2="1357.25"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="939" y="1365.25"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="78" x="951" y="1372.998">totalFrames: int</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="939" y="1379.55"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="89" x="951" y="1387.298">correctFrames: int</text><line style="stroke:#000000;stroke-width:1.0;" x1="932" x2="1073" y1="1393.85" y2="1393.85"/><ellipse cx="942" cy="1404.85" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="29" x="951" y="1409.598">start()</text><ellipse cx="942" cy="1419.15" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="117" x="951" y="1423.898">recordFrame(feedbacks)</text><ellipse cx="942" cy="1433.45" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="103" x="951" y="1438.198">getSummary(): object</text><!--MD5=[828ae382eab9d522464ba4a27d91b499]
class BackgroundManager--><rect codeLine="130" fill="#FFFFFF" filter="url(#f1ecy08j79xg27)" height="133.8" id="BackgroundManager" style="stroke:#000000;stroke-width:1.5;" width="257" x="874" y="1057.1"/><ellipse cx="944.25" cy="1073.1" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M946.7231,1079.2431 Q946.1421,1079.5419 945.5029,1079.6913 Q944.8638,1079.8407 944.1582,1079.8407 Q941.6514,1079.8407 940.3315,1078.1889 Q939.0117,1076.537 939.0117,1073.4159 Q939.0117,1070.2865 940.3315,1068.6347 Q941.6514,1066.9828 944.1582,1066.9828 Q944.8638,1066.9828 945.5112,1067.1322 Q946.1587,1067.2816 946.7231,1067.5805 L946.7231,1070.3031 Q946.0923,1069.7221 945.4988,1069.4523 Q944.9053,1069.1825 944.2744,1069.1825 Q942.9297,1069.1825 942.2449,1070.2492 Q941.5601,1071.3158 941.5601,1073.4159 Q941.5601,1075.5077 942.2449,1076.5744 Q942.9297,1077.641 944.2744,1077.641 Q944.9053,1077.641 945.4988,1077.3712 Q946.0923,1077.1015 946.7231,1076.5204 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="108" x="964.75" y="1078.116">BackgroundManager</text><line style="stroke:#000000;stroke-width:1.5;" x1="875" x2="1130" y1="1089.1" y2="1089.1"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="882" y="1097.1"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="61" x="894" y="1104.848">mode: string</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="882" y="1111.4"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="100" x="894" y="1119.148">blurAmount: number</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="882" y="1125.7"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="122" x="894" y="1133.448">backgroundImage: Image</text><line style="stroke:#000000;stroke-width:1.0;" x1="875" x2="1130" y1="1140" y2="1140"/><ellipse cx="885" cy="1151" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="75" x="894" y="1155.748">setMode(mode)</text><ellipse cx="885" cy="1165.3" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="115" x="894" y="1170.048">setBlurAmount(amount)</text><ellipse cx="885" cy="1179.6" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="231" x="894" y="1184.348">drawBackground(ctx, mask, video, width, height)</text><!--MD5=[7065e7be84ffd0ebe64c11e25c182e37]
class DrawingManager--><rect codeLine="140" fill="#FFFFFF" filter="url(#f1ecy08j79xg27)" height="233.9" id="DrawingManager" style="stroke:#000000;stroke-width:1.5;" width="213" x="896" y="517.05"/><ellipse cx="955.25" cy="533.05" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M957.7231,539.1931 Q957.1421,539.4919 956.5029,539.6413 Q955.8638,539.7907 955.1582,539.7907 Q952.6514,539.7907 951.3315,538.1389 Q950.0117,536.487 950.0117,533.3659 Q950.0117,530.2365 951.3315,528.5847 Q952.6514,526.9328 955.1582,526.9328 Q955.8638,526.9328 956.5112,527.0822 Q957.1587,527.2316 957.7231,527.5305 L957.7231,530.2531 Q957.0923,529.6721 956.4988,529.4023 Q955.9053,529.1325 955.2744,529.1325 Q953.9297,529.1325 953.2449,530.1992 Q952.5601,531.2658 952.5601,533.3659 Q952.5601,535.4577 953.2449,536.5244 Q953.9297,537.591 955.2744,537.591 Q955.9053,537.591 956.4988,537.3212 Q957.0923,537.0515 957.7231,536.4704 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="86" x="975.75" y="538.066">DrawingManager</text><line style="stroke:#000000;stroke-width:1.5;" x1="897" x2="1108" y1="549.05" y2="549.05"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="904" y="557.05"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="153" x="916" y="564.798">ctx: CanvasRenderingContext2D</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="904" y="571.35"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="95" x="916" y="579.098">isMirrored: boolean</text><line style="stroke:#000000;stroke-width:1.0;" x1="897" x2="1108" y1="585.65" y2="585.65"/><ellipse cx="907" cy="596.65" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="121" x="916" y="601.398">drawSkeleton(landmarks)</text><ellipse cx="907" cy="610.95" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="103" x="916" y="615.698">drawPath(path, color)</text><ellipse cx="907" cy="625.25" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="84" x="916" y="629.998">drawTrail(history)</text><ellipse cx="907" cy="639.55" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="151" x="916" y="644.298">drawFeedbackPanel(feedbacks)</text><ellipse cx="907" cy="653.85" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="145" x="916" y="658.598">drawDebugOverlay(debugInfo)</text><ellipse cx="907" cy="668.15" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="149" x="916" y="672.898">drawGhostSkeleton(landmarks)</text><ellipse cx="907" cy="682.45" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="174" x="916" y="687.198">drawSilhouetteVideo(video, opacity)</text><ellipse cx="907" cy="696.75" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="134" x="916" y="701.498">drawSilhouette(mask, color)</text><ellipse cx="907" cy="711.05" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="157" x="916" y="715.798">drawGestureFeedback(feedback)</text><ellipse cx="907" cy="725.35" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="147" x="916" y="730.098">drawCircularityIndicator(score)</text><ellipse cx="907" cy="739.65" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="187" x="916" y="744.398">drawErrorHighlights(landmarks, errors)</text><!--MD5=[27430a77e3018f6a78460c75ee8741e0]
class GhostManager--><rect codeLine="157" fill="#FFFFFF" filter="url(#f1ecy08j79xg27)" height="205.3" id="GhostManager" style="stroke:#000000;stroke-width:1.5;" width="205" x="900" y="801.35"/><ellipse cx="959.75" cy="817.35" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M962.2231,823.4931 Q961.6421,823.7919 961.0029,823.9413 Q960.3638,824.0907 959.6582,824.0907 Q957.1514,824.0907 955.8315,822.4389 Q954.5117,820.787 954.5117,817.6659 Q954.5117,814.5365 955.8315,812.8847 Q957.1514,811.2328 959.6582,811.2328 Q960.3638,811.2328 961.0112,811.3822 Q961.6587,811.5316 962.2231,811.8305 L962.2231,814.5531 Q961.5923,813.9721 960.9988,813.7023 Q960.4053,813.4325 959.7744,813.4325 Q958.4297,813.4325 957.7449,814.4992 Q957.0601,815.5658 957.0601,817.6659 Q957.0601,819.7577 957.7449,820.8244 Q958.4297,821.891 959.7744,821.891 Q960.4053,821.891 960.9988,821.6212 Q961.5923,821.3515 962.2231,820.7704 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="77" x="980.25" y="822.366">GhostManager</text><line style="stroke:#000000;stroke-width:1.5;" x1="901" x2="1104" y1="833.35" y2="833.35"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="908" y="841.35"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="88" x="920" y="849.098">isPlaying: boolean</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="908" y="855.65"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="78" x="920" y="863.398">opacity: number</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="908" y="869.95"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="179" x="920" y="877.698">silhouetteVideo: HTMLVideoElement</text><line style="stroke:#000000;stroke-width:1.0;" x1="901" x2="1104" y1="884.25" y2="884.25"/><ellipse cx="911" cy="895.25" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="49" x="920" y="899.998">load(data)</text><ellipse cx="911" cy="909.55" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="118" x="920" y="914.298">loadSilhouetteVideo(url)</text><ellipse cx="911" cy="923.85" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="29" x="920" y="928.598">start()</text><ellipse cx="911" cy="938.15" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="27" x="920" y="942.898">stop()</text><ellipse cx="911" cy="952.45" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="40" x="920" y="957.198">update()</text><ellipse cx="911" cy="966.75" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="89" x="920" y="971.498">getCurrentFrame()</text><ellipse cx="911" cy="981.05" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="80" x="920" y="985.798">setSpeed(speed)</text><ellipse cx="911" cy="995.35" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="92" x="920" y="1000.098">setOpacity(opacity)</text><!--MD5=[d602b77267d5088762cb6a59b8ed96b1]
class UIManager--><rect codeLine="183" fill="#FFFFFF" filter="url(#f1ecy08j79xg27)" height="162.4" id="UIManager" style="stroke:#000000;stroke-width:1.5;" width="143" x="380" y="281.8"/><ellipse cx="419.3" cy="297.8" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M421.7731,303.9431 Q421.1921,304.2419 420.5529,304.3913 Q419.9138,304.5407 419.2082,304.5407 Q416.7014,304.5407 415.3815,302.8889 Q414.0617,301.237 414.0617,298.1159 Q414.0617,294.9865 415.3815,293.3347 Q416.7014,291.6828 419.2082,291.6828 Q419.9138,291.6828 420.5612,291.8322 Q421.2087,291.9816 421.7731,292.2805 L421.7731,295.0031 Q421.1423,294.4221 420.5488,294.1523 Q419.9553,293.8825 419.3244,293.8825 Q417.9797,293.8825 417.2949,294.9492 Q416.6101,296.0158 416.6101,298.1159 Q416.6101,300.2077 417.2949,301.2744 Q417.9797,302.341 419.3244,302.341 Q419.9553,302.341 420.5488,302.0712 Q421.1423,301.8015 421.7731,301.2204 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="57" x="438.7" y="302.816">UIManager</text><line style="stroke:#000000;stroke-width:1.5;" x1="381" x2="522" y1="313.8" y2="313.8"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="388" y="321.8"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="93" x="400" y="329.548">currentLang: string</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="388" y="336.1"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="102" x="400" y="343.848">currentTheme: string</text><line style="stroke:#000000;stroke-width:1.0;" x1="381" x2="522" y1="350.4" y2="350.4"/><ellipse cx="391" cy="361.4" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="85" x="400" y="366.148">toggleLanguage()</text><ellipse cx="391" cy="375.7" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="70" x="400" y="380.448">toggleTheme()</text><ellipse cx="391" cy="390" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="85" x="400" y="394.748">toggleLanguage()</text><ellipse cx="391" cy="404.3" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="70" x="400" y="409.048">toggleTheme()</text><ellipse cx="391" cy="418.6" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="108" x="400" y="423.348">showNotification(msg)</text><ellipse cx="391" cy="432.9" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="117" x="400" y="437.648">closeAllMenus(exceptId)</text><!--MD5=[347a6de240a7e533fe3f585d0ed7a7fe]
class AudioManager--><rect codeLine="195" fill="#FFFFFF" filter="url(#f1ecy08j79xg27)" height="133.8" id="AudioManager" style="stroke:#000000;stroke-width:1.5;" width="182" x="360.5" y="98.1"/><ellipse cx="409.25" cy="114.1" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M411.7231,120.2431 Q411.1421,120.5419 410.5029,120.6913 Q409.8638,120.8407 409.1582,120.8407 Q406.6514,120.8407 405.3315,119.1889 Q404.0117,117.537 404.0117,114.4159 Q404.0117,111.2865 405.3315,109.6347 Q406.6514,107.9828 409.1582,107.9828 Q409.8638,107.9828 410.5112,108.1322 Q411.1587,108.2816 411.7231,108.5805 L411.7231,111.3031 Q411.0923,110.7221 410.4988,110.4523 Q409.9053,110.1825 409.2744,110.1825 Q407.9297,110.1825 407.2449,111.2492 Q406.5601,112.3158 406.5601,114.4159 Q406.5601,116.5077 407.2449,117.5744 Q407.9297,118.641 409.2744,118.641 Q409.9053,118.641 410.4988,118.3712 Q411.0923,118.1015 411.7231,117.5204 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="76" x="429.75" y="119.116">AudioManager</text><line style="stroke:#000000;stroke-width:1.5;" x1="361.5" x2="541.5" y1="130.1" y2="130.1"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="368.5" y="138.1"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="84" x="380.5" y="145.848">enabled: boolean</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="368.5" y="152.4"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="88" x="380.5" y="160.148">cooldown: number</text><line style="stroke:#000000;stroke-width:1.0;" x1="361.5" x2="541.5" y1="166.7" y2="166.7"/><ellipse cx="371.5" cy="177.7" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="77" x="380.5" y="182.448">speak(message)</text><ellipse cx="371.5" cy="192" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="129" x="380.5" y="196.748">speakFeedback(feedbacks)</text><ellipse cx="371.5" cy="206.3" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="98" x="380.5" y="211.048">waitForIdle(timeout)</text><ellipse cx="371.5" cy="220.6" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="156" x="380.5" y="225.348">getExerciseSpokenText(id, level)</text><!--MD5=[1dd07b0d44aee610d043a0002d5988d9]
class TutorialManager--><rect codeLine="205" fill="#FFFFFF" filter="url(#f1ecy08j79xg27)" height="90.9" id="TutorialManager" style="stroke:#000000;stroke-width:1.5;" width="119" x="392" y="494.55"/><ellipse cx="407" cy="510.55" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M409.4731,516.6931 Q408.8921,516.9919 408.2529,517.1413 Q407.6138,517.2907 406.9082,517.2907 Q404.4014,517.2907 403.0815,515.6389 Q401.7617,513.987 401.7617,510.8659 Q401.7617,507.7365 403.0815,506.0847 Q404.4014,504.4328 406.9082,504.4328 Q407.6138,504.4328 408.2612,504.5822 Q408.9087,504.7316 409.4731,505.0305 L409.4731,507.7531 Q408.8423,507.1721 408.2488,506.9023 Q407.6553,506.6325 407.0244,506.6325 Q405.6797,506.6325 404.9949,507.6992 Q404.3101,508.7658 404.3101,510.8659 Q404.3101,512.9577 404.9949,514.0244 Q405.6797,515.091 407.0244,515.091 Q407.6553,515.091 408.2488,514.8212 Q408.8423,514.5515 409.4731,513.9704 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="87" x="421" y="515.566">TutorialManager</text><line style="stroke:#000000;stroke-width:1.5;" x1="393" x2="510" y1="526.55" y2="526.55"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="400" y="534.55"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="78" x="412" y="542.298">isOpen: boolean</text><line style="stroke:#000000;stroke-width:1.0;" x1="393" x2="510" y1="548.85" y2="548.85"/><ellipse cx="403" cy="559.85" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="51" x="412" y="564.598">open(lang)</text><ellipse cx="403" cy="574.15" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="31" x="412" y="578.898">close()</text><!--MD5=[1027430669dbe09cf3ac84b359d871ec]
class ScorePopupManager--><rect codeLine="212" fill="#FFFFFF" filter="url(#f1ecy08j79xg27)" height="76.6" id="ScorePopupManager" style="stroke:#000000;stroke-width:1.5;" width="141" x="639.5" y="508.7"/><ellipse cx="654.5" cy="524.7" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M656.9731,530.8431 Q656.3921,531.1419 655.7529,531.2913 Q655.1138,531.4407 654.4082,531.4407 Q651.9014,531.4407 650.5815,529.7889 Q649.2617,528.137 649.2617,525.0159 Q649.2617,521.8865 650.5815,520.2347 Q651.9014,518.5828 654.4082,518.5828 Q655.1138,518.5828 655.7612,518.7322 Q656.4087,518.8816 656.9731,519.1805 L656.9731,521.9031 Q656.3423,521.3221 655.7488,521.0523 Q655.1553,520.7825 654.5244,520.7825 Q653.1797,520.7825 652.4949,521.8492 Q651.8101,522.9158 651.8101,525.0159 Q651.8101,527.1077 652.4949,528.1744 Q653.1797,529.241 654.5244,529.241 Q655.1553,529.241 655.7488,528.9712 Q656.3423,528.7015 656.9731,528.1204 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="109" x="668.5" y="529.716">ScorePopupManager</text><line style="stroke:#000000;stroke-width:1.5;" x1="640.5" x2="779.5" y1="540.7" y2="540.7"/><line style="stroke:#000000;stroke-width:1.0;" x1="640.5" x2="779.5" y1="548.7" y2="548.7"/><ellipse cx="650.5" cy="559.7" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="108" x="659.5" y="564.448">show(summary, grade)</text><ellipse cx="650.5" cy="574" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="31" x="659.5" y="578.748">close()</text><!--MD5=[ca58359f07f9a4065c7e5ec85443e727]
class RulesConfigManager--><rect codeLine="218" fill="#FFFFFF" filter="url(#f1ecy08j79xg27)" height="76.6" id="RulesConfigManager" style="stroke:#000000;stroke-width:1.5;" width="168" x="626" y="381.7"/><ellipse cx="654.05" cy="397.7" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M656.5231,403.8431 Q655.9421,404.1419 655.3029,404.2913 Q654.6638,404.4407 653.9582,404.4407 Q651.4514,404.4407 650.1315,402.7889 Q648.8117,401.137 648.8117,398.0159 Q648.8117,394.8865 650.1315,393.2347 Q651.4514,391.5828 653.9582,391.5828 Q654.6638,391.5828 655.3112,391.7322 Q655.9587,391.8816 656.5231,392.1805 L656.5231,394.9031 Q655.8923,394.3221 655.2988,394.0523 Q654.7053,393.7825 654.0744,393.7825 Q652.7297,393.7825 652.0449,394.8492 Q651.3601,395.9158 651.3601,398.0159 Q651.3601,400.1077 652.0449,401.1744 Q652.7297,402.241 654.0744,402.241 Q654.7053,402.241 655.2988,401.9712 Q655.8923,401.7015 656.5231,401.1204 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="107" x="670.95" y="402.716">RulesConfigManager</text><line style="stroke:#000000;stroke-width:1.5;" x1="627" x2="793" y1="413.7" y2="413.7"/><line style="stroke:#000000;stroke-width:1.0;" x1="627" x2="793" y1="421.7" y2="421.7"/><ellipse cx="637" cy="432.7" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="142" x="646" y="437.448">setRuleEnabled(key, enabled)</text><ellipse cx="637" cy="447" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="84" x="646" y="451.748">resetToDefaults()</text><!--MD5=[45ce707b976a738d2e4595cad6afaa40]
class GestureManager--><rect codeLine="224" fill="#FFFFFF" filter="url(#f1ecy08j79xg27)" height="90.9" id="GestureManager" style="stroke:#000000;stroke-width:1.5;" width="132" x="644" y="85.55"/><ellipse cx="665.3" cy="101.55" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M667.7731,107.6931 Q667.1921,107.9919 666.5529,108.1413 Q665.9138,108.2907 665.2082,108.2907 Q662.7014,108.2907 661.3815,106.6389 Q660.0617,104.987 660.0617,101.8659 Q660.0617,98.7365 661.3815,97.0847 Q662.7014,95.4328 665.2082,95.4328 Q665.9138,95.4328 666.5612,95.5822 Q667.2087,95.7316 667.7731,96.0305 L667.7731,98.7531 Q667.1423,98.1721 666.5488,97.9023 Q665.9553,97.6325 665.3244,97.6325 Q663.9797,97.6325 663.2949,98.6992 Q662.6101,99.7658 662.6101,101.8659 Q662.6101,103.9577 663.2949,105.0244 Q663.9797,106.091 665.3244,106.091 Q665.9553,106.091 666.5488,105.8212 Q667.1423,105.5515 667.7731,104.9704 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="86" x="680.7" y="106.566">GestureManager</text><line style="stroke:#000000;stroke-width:1.5;" x1="645" x2="775" y1="117.55" y2="117.55"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="652" y="125.55"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="82" x="664" y="133.298">isReady: boolean</text><line style="stroke:#000000;stroke-width:1.0;" x1="645" x2="775" y1="139.85" y2="139.85"/><ellipse cx="655" cy="150.85" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="22" x="664" y="155.598">init()</text><ellipse cx="655" cy="165.15" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="106" x="664" y="169.898">detectGestures(video)</text><!--MD5=[a53eb7802fcf6e4afed3783382088263]
class FeedbackManager--><rect codeLine="231" fill="#FFFFFF" filter="url(#f1ecy08j79xg27)" height="105.2" id="FeedbackManager" style="stroke:#000000;stroke-width:1.5;" width="128" x="646" y="226.4"/><ellipse cx="661" cy="242.4" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M663.4731,248.5431 Q662.8921,248.8419 662.2529,248.9913 Q661.6138,249.1407 660.9082,249.1407 Q658.4014,249.1407 657.0815,247.4889 Q655.7617,245.837 655.7617,242.7159 Q655.7617,239.5865 657.0815,237.9347 Q658.4014,236.2828 660.9082,236.2828 Q661.6138,236.2828 662.2612,236.4322 Q662.9087,236.5816 663.4731,236.8805 L663.4731,239.6031 Q662.8423,239.0221 662.2488,238.7523 Q661.6553,238.4825 661.0244,238.4825 Q659.6797,238.4825 658.9949,239.5492 Q658.3101,240.6158 658.3101,242.7159 Q658.3101,244.8077 658.9949,245.8744 Q659.6797,246.941 661.0244,246.941 Q661.6553,246.941 662.2488,246.6712 Q662.8423,246.4015 663.4731,245.8204 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="96" x="675" y="247.416">FeedbackManager</text><line style="stroke:#000000;stroke-width:1.5;" x1="647" x2="773" y1="258.4" y2="258.4"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="654" y="266.4"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="71" x="666" y="274.148">formUrl: string</text><line style="stroke:#000000;stroke-width:1.0;" x1="647" x2="773" y1="280.7" y2="280.7"/><ellipse cx="657" cy="291.7" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="69" x="666" y="296.448">createButton()</text><ellipse cx="657" cy="306" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="60" x="666" y="310.748">showPopup()</text><ellipse cx="657" cy="320.3" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="46" x="666" y="325.048">getLang()</text><!--MD5=[f097a9da547c6f19ba7a5c97c093eb18]
class SessionManager--><rect codeLine="255" fill="#FFFFFF" filter="url(#f1ecy08j79xg27)" height="85.8" id="SessionManager" style="stroke:#000000;stroke-width:1.5;" width="122" x="390.5" y="1276.1"/><ellipse cx="408.2" cy="1296.7" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M410.6731,1302.8431 Q410.0921,1303.1419 409.4529,1303.2913 Q408.8138,1303.4407 408.1082,1303.4407 Q405.6014,1303.4407 404.2815,1301.7889 Q402.9617,1300.137 402.9617,1297.0159 Q402.9617,1293.8865 404.2815,1292.2347 Q405.6014,1290.5828 408.1082,1290.5828 Q408.8138,1290.5828 409.4612,1290.7322 Q410.1087,1290.8816 410.6731,1291.1805 L410.6731,1293.9031 Q410.0423,1293.3221 409.4488,1293.0523 Q408.8553,1292.7825 408.2244,1292.7825 Q406.8797,1292.7825 406.1949,1293.8492 Q405.5101,1294.9158 405.5101,1297.0159 Q405.5101,1299.1077 406.1949,1300.1744 Q406.8797,1301.241 408.2244,1301.241 Q408.8553,1301.241 409.4488,1300.9712 Q410.0423,1300.7015 410.6731,1300.1204 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="45" x="442.3" y="1293.916">«Utility»</text><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="84" x="422.8" y="1309.516">SessionManager</text><line style="stroke:#000000;stroke-width:1.5;" x1="391.5" x2="511.5" y1="1317.3" y2="1317.3"/><line style="stroke:#000000;stroke-width:1.5;" x1="391.5" x2="511.5" y1="1325.3" y2="1325.3"/><ellipse cx="401.5" cy="1336.3" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="96" x="410.5" y="1341.048">getOrCreateUserId()</text><ellipse cx="401.5" cy="1350.6" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="96" x="410.5" y="1355.348">generateSessionId()</text><!--MD5=[cbfd515719b6910b093ca89747820c68]
class PathGenerator--><rect codeLine="260" fill="#FFFFFF" filter="url(#f1ecy08j79xg27)" height="71.5" id="PathGenerator" style="stroke:#000000;stroke-width:1.5;" width="235" x="334" y="1154.25"/><ellipse cx="408.25" cy="1174.85" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M410.7231,1180.9931 Q410.1421,1181.2919 409.5029,1181.4413 Q408.8638,1181.5907 408.1582,1181.5907 Q405.6514,1181.5907 404.3315,1179.9389 Q403.0117,1178.287 403.0117,1175.1659 Q403.0117,1172.0365 404.3315,1170.3847 Q405.6514,1168.7328 408.1582,1168.7328 Q408.8638,1168.7328 409.5112,1168.8822 Q410.1587,1169.0316 410.7231,1169.3305 L410.7231,1172.0531 Q410.0923,1171.4721 409.4988,1171.2023 Q408.9053,1170.9325 408.2744,1170.9325 Q406.9297,1170.9325 406.2449,1171.9992 Q405.5601,1173.0658 405.5601,1175.1659 Q405.5601,1177.2577 406.2449,1178.3244 Q406.9297,1179.391 408.2744,1179.391 Q408.9053,1179.391 409.4988,1179.1212 Q410.0923,1178.8515 410.7231,1178.2704 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="45" x="445.25" y="1172.066">«Utility»</text><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="78" x="428.75" y="1187.666">PathGenerator</text><line style="stroke:#000000;stroke-width:1.5;" x1="335" x2="568" y1="1195.45" y2="1195.45"/><line style="stroke:#000000;stroke-width:1.5;" x1="335" x2="568" y1="1203.45" y2="1203.45"/><ellipse cx="345" cy="1214.45" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="209" x="354" y="1219.198">generateDynamicPath(landmarks, exercise)</text><!--MD5=[e219136ea99e406b0a84800811d2e145]
class DataExporter--><rect codeLine="264" fill="#FFFFFF" filter="url(#f1ecy08j79xg27)" height="85.8" id="DataExporter" style="stroke:#000000;stroke-width:1.5;" width="111" x="396" y="1412.1"/><ellipse cx="415.05" cy="1432.7" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M417.5231,1438.8431 Q416.9421,1439.1419 416.3029,1439.2913 Q415.6638,1439.4407 414.9582,1439.4407 Q412.4514,1439.4407 411.1315,1437.7889 Q409.8117,1436.137 409.8117,1433.0159 Q409.8117,1429.8865 411.1315,1428.2347 Q412.4514,1426.5828 414.9582,1426.5828 Q415.6638,1426.5828 416.3112,1426.7322 Q416.9587,1426.8816 417.5231,1427.1805 L417.5231,1429.9031 Q416.8923,1429.3221 416.2988,1429.0523 Q415.7053,1428.7825 415.0744,1428.7825 Q413.7297,1428.7825 413.0449,1429.8492 Q412.3601,1430.9158 412.3601,1433.0159 Q412.3601,1435.1077 413.0449,1436.1744 Q413.7297,1437.241 415.0744,1437.241 Q415.7053,1437.241 416.2988,1436.9712 Q416.8923,1436.7015 417.5231,1436.1204 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="45" x="442.45" y="1429.916">«Utility»</text><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="70" x="429.95" y="1445.516">DataExporter</text><line style="stroke:#000000;stroke-width:1.5;" x1="397" x2="506" y1="1453.3" y2="1453.3"/><line style="stroke:#000000;stroke-width:1.5;" x1="397" x2="506" y1="1461.3" y2="1461.3"/><ellipse cx="407" cy="1472.3" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="85" x="416" y="1477.048">exportJSON(data)</text><ellipse cx="407" cy="1486.6" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="78" x="416" y="1491.348">exportCSV(data)</text><path d="M6,485.5 L6,664.5 L278,664.5 L278,495.5 L268,485.5 L6,485.5 " fill="#FBFB77" filter="url(#f1ecy08j79xg27)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M268,485.5 L268,495.5 L278,495.5 L268,485.5 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="145" x="12" y="504.384">TaijiFlow AI Architecture</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="0" x="15" y="521.284"/><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="172" x="12" y="538.184">MVC-like Pattern (5 Packages):</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="4" x="12" y="555.084">-</text><text fill="#000000" font-family="sarabun" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="67" x="19" y="555.084">Controllers</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="170" x="86" y="555.084">: script.js + Keyboard + Display</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="4" x="12" y="571.984">-</text><text fill="#000000" font-family="sarabun" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="19" y="571.984">Core</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="216" x="47" y="571.984">: HeuristicsEngine, Calibration, Scoring</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="4" x="12" y="588.884">-</text><text fill="#000000" font-family="sarabun" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="43" x="19" y="588.884">Display</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="163" x="62" y="588.884">: Drawing, Ghost, Background</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="4" x="12" y="605.784">-</text><text fill="#000000" font-family="sarabun" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="13" x="19" y="605.784">UI</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="123" x="32" y="605.784">: UIManager + 6 more</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="4" x="12" y="622.684">-</text><text fill="#000000" font-family="sarabun" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="38" x="19" y="622.684">Utility</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="134" x="57" y="622.684">: Session, Path, Exporter</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="0" x="15" y="639.584"/><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="164" x="12" y="656.484">Total: 18 Classes, 21 Modules</text><!--MD5=[32b2559013a2af7d3fbb88a153276af5]
link DrawingManager to GhostManager--><!--MD5=[611aeed3de9f8f9f0e8e54271a83fcd1]
link GhostManager to BackgroundManager--><!--MD5=[51eaa1b43a149febd10d66dbba0f63b6]
link UIManager to AudioManager--><!--MD5=[206c125da6c0fa549c2eb92f359766ca]
link AudioManager to TutorialManager--><!--MD5=[a0969e0435b22411c39d04728eb08a32]
link TutorialManager to ScorePopupManager--><!--MD5=[17a773bcde99f8f6aad6ef435d752061]
link ScorePopupManager to RulesConfigManager--><!--MD5=[78b5e27333e049fa5626f7341eb605de]
link RulesConfigManager to GestureManager--><!--MD5=[ec4871536f25f262224859d313d60b14]
link GestureManager to FeedbackManager--><!--MD5=[8ecf8a2be7bc1144d736fe69cb3dc5d0]
link SessionManager to PathGenerator--><!--MD5=[b4153a4765cd3212441a027f5c92dbfd]
link PathGenerator to DataExporter--><!--MD5=[bf3c87166e1461fb0037a62116064262]
link Script to KeyboardController--><path codeLine="280" d="M234.44,967 C234.44,967 377.1,967 377.1,967 " fill="none" id="Script-to-KeyboardController" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="382.1,967,373.1,963,377.1,967,373.1,971,382.1,967" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[066c35afdd785367532baf5480047ad9]
link Script to DisplayController--><path codeLine="281" d="M234.21,914.26 C234.21,914.26 618.33,914.26 618.33,914.26 " fill="none" id="Script-to-DisplayController" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="623.33,914.26,614.33,910.26,618.33,914.26,614.33,918.26,623.33,914.26" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[bb640fb10fb5d2929dca8b96a4ce4b2e]
link Script to HeuristicsEngine--><path codeLine="282" d="M234.35,1019.82 C367.34,1019.82 597,1019.82 597,1019.82 C597,1019.82 597,1305.59 597,1305.59 C597,1305.59 1164.33,1305.59 1164.33,1305.59 " fill="none" id="Script-to-HeuristicsEngine" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="1169.33,1305.59,1160.33,1301.59,1164.33,1305.59,1160.33,1309.59,1169.33,1305.59" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[df44e9dcfa25f6d6d0ebc55302acba7f]
link Script to CalibrationManager--><path codeLine="283" d="M87,1035.2 C87,1041.79 87,1045.95 87,1045.95 C87,1045.95 1456,1045.95 1456,1045.95 C1456,1045.95 1456,1296.08 1456,1296.08 " fill="none" id="Script-to-CalibrationManager" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="1456,1301.08,1460,1292.08,1456,1296.08,1452,1292.08,1456,1301.08" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[e96b2d5337d6cc8c6fa37ff8fa78d55e]
link Script to DrawingManager--><path codeLine="284" d="M234.36,877.79 C299.06,877.79 374,877.79 374,877.79 C374,877.79 374,739.33 374,739.33 C374,739.33 889.01,739.33 889.01,739.33 " fill="none" id="Script-to-DrawingManager" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="894.01,739.32,885.01,735.32,889.01,739.32,885.01,743.32,894.01,739.32" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[316c9feee76975263e4d8c48afaa721b]
link Script to BackgroundManager--><path codeLine="285" d="M197,1035.13 C197,1071.54 197,1105.67 197,1105.67 C197,1105.67 867.02,1105.67 867.02,1105.67 " fill="none" id="Script-to-BackgroundManager" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="872.02,1105.67,863.02,1101.67,867.02,1105.67,863.02,1109.67,872.02,1105.67" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[6fbfb2b36488141d6f4cc532d3959812]
link Script to UIManager--><path codeLine="286" d="M234.3,885.08 C304.1,885.08 388,885.08 388,885.08 C388,885.08 388,451.09 388,451.09 " fill="none" id="Script-to-UIManager" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="388,446.09,384,455.09,388,451.09,392,455.09,388,446.09" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[1b30a48cdca0eca6112e471747dd5049]
link Script to AudioManager--><path codeLine="287" d="M234.49,870.49 C296.55,870.49 367,870.49 367,870.49 C367,870.49 367,238.84 367,238.84 " fill="none" id="Script-to-AudioManager" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="367,233.84,363,242.84,367,238.84,371,242.84,367,233.84" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[d3159cad506f0cb1a1310c2a9273c5ba]
link Script to TutorialManager--><path codeLine="288" d="M234.17,892.38 C325.55,892.38 452,892.38 452,892.38 C452,892.38 452,592.22 452,592.22 " fill="none" id="Script-to-TutorialManager" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="452,587.22,448,596.22,452,592.22,456,596.22,452,587.22" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[c9d5948225815dc913d981d595174205]
link Script to GestureManager--><path codeLine="289" d="M234.39,906.96 C356.41,906.96 556,906.96 556,906.96 C556,906.96 556,124.22 556,124.22 C556,124.22 637.28,124.22 637.28,124.22 " fill="none" id="Script-to-GestureManager" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="642.28,124.22,633.28,120.22,637.28,124.22,633.28,128.22,642.28,124.22" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[054d7b1fdba22383893cfa838083967a]
link DisplayController to GhostManager--><path codeLine="292" d="M795.39,904 C795.39,904 893.14,904 893.14,904 " fill="none" id="DisplayController-to-GhostManager" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="898.14,904,889.14,900,893.14,904,889.14,908,898.14,904" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[a17a43ae14a6d55146cc3d2e4d7a0615]
link DisplayController to BackgroundManager--><path codeLine="293" d="M795.45,1020.6 C839.87,1020.6 885,1020.6 885,1020.6 C885,1020.6 885,1050.25 885,1050.25 " fill="none" id="DisplayController-to-BackgroundManager" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="885,1055.25,889,1046.25,885,1050.25,881,1046.25,885,1055.25" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[114b1c542304188696707e3b7725b454]
link KeyboardController to DisplayController--><path codeLine="294" d="M519.42,967 C519.42,967 618.44,967 618.44,967 " fill="none" id="KeyboardController-to-DisplayController" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#000000" points="623.44,967,614.44,963,618.44,967,614.44,971,623.44,967" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[93c85ec313925d227df23d58d1ea3cf5]
link HeuristicsEngine to CalibrationManager--><path codeLine="297" d="M1348.49,1391 C1348.49,1391 1381.17,1391 1381.17,1391 " fill="none" id="HeuristicsEngine-to-CalibrationManager" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#000000" points="1386.17,1391,1377.17,1387,1381.17,1391,1377.17,1395,1386.17,1391" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[f54eabe09eee0fd5b70ad09dfcf80d76]
reverse link ScoringManager to HeuristicsEngine--><path codeLine="298" d="M1080.94,1385 C1080.94,1385 1170.64,1385 1170.64,1385 " fill="none" id="ScoringManager-backto-HeuristicsEngine" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#000000" points="1075.94,1385,1084.94,1389,1080.94,1385,1084.94,1381,1075.94,1385" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[8130cbae6e915c6bd816ad1177fd8668]
reverse link DrawingManager to HeuristicsEngine--><path codeLine="299" d="M1115.77,634 C1115.77,634 1230,634 1230,634 C1230,634 1230,1081.55 1230,1285.66 " fill="none" id="DrawingManager-backto-HeuristicsEngine" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#000000" points="1110.77,634,1119.77,638,1115.77,634,1119.77,630,1110.77,634" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[21cbf8643b8569618ababa145af3b81c]
link UIManager to ScorePopupManager--><path codeLine="302" d="M515,444.6 C515,488.71 515,534.23 515,534.23 C515,534.23 632.54,534.23 632.54,534.23 " fill="none" id="UIManager-to-ScorePopupManager" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="637.54,534.23,628.54,530.23,632.54,534.23,628.54,538.23,637.54,534.23" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[6cc97f7bc7c31b26f16b0bdedb965ee3]
link ScoringManager to ScorePopupManager--><path codeLine="303" d="M930.98,1343.58 C885.45,1343.58 835,1343.58 835,1343.58 C835,1343.58 835,551.18 835,551.18 C835,551.18 787.41,551.18 787.41,551.18 " fill="none" id="ScoringManager-to-ScorePopupManager" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#000000" points="782.41,551.17,791.41,555.17,787.41,551.17,791.41,547.17,782.41,551.17" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[fefc158ffacc74b4ea6c698976d9bb28]
link Script to FeedbackManager--><path codeLine="304" d="M234.38,899.67 C350.83,899.67 536,899.67 536,899.67 C536,899.67 536,306.7 536,306.7 C536,306.7 639.19,306.7 639.19,306.7 " fill="none" id="Script-to-FeedbackManager" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="644.19,306.7,635.19,302.7,639.19,306.7,635.19,310.7,644.19,306.7" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[9b185d876e8dca1007bb9a7007ca0ac2]
link RulesConfigManager to HeuristicsEngine--><path codeLine="305" d="M794.19,420 C954.78,420 1289,420 1289,420 C1289,420 1289,1279.3 1289,1279.3 " fill="none" id="RulesConfigManager-to-HeuristicsEngine" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="1289,1284.3,1293,1275.3,1289,1279.3,1285,1275.3,1289,1284.3" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[e978cfe7b79b9a9eecbc1f12c7812525]
link Script to SessionManager--><path codeLine="308" d="M160,1035.28 C160,1144.61 160,1319 160,1319 C160,1319 383.52,1319 383.52,1319 " fill="none" id="Script-to-SessionManager" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#000000" points="388.52,1319,379.52,1315,383.52,1319,379.52,1323,388.52,1319" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[a0e975fe68959f3d5f45bfbb14c56c08]
link Script to PathGenerator--><path codeLine="309" d="M234.31,1027.18 C288.72,1027.18 347,1027.18 347,1027.18 C347,1027.18 347,1147.35 347,1147.35 " fill="none" id="Script-to-PathGenerator" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#000000" points="347,1152.35,351,1143.35,347,1147.35,343,1143.35,347,1152.35" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[107d199cd8363bbd797a6879dcd0743d]
link Script to DataExporter--><path codeLine="310" d="M124,1035.12 C124,1179.56 124,1455 124,1455 C124,1455 389.06,1455 389.06,1455 " fill="none" id="Script-to-DataExporter" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#000000" points="394.06,1455,385.06,1451,389.06,1455,385.06,1459,394.06,1455" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[252881b5e75cb9ae9502d9d6e038cabd]
@startuml TaijiFlow_Class_Diagram
' ============================================================================
' TaijiFlow AI - Class Diagram v1.2 (Updated: 2026-01-07)
' ============================================================================
' จัดกลุ่มด้วย Packages เพื่อความชัดเจน
' อ้างอิง: 21 JavaScript Modules
' ============================================================================

skinparam defaultFontName "sarabun"
skinparam packageStyle rectangle

' === Line Style Settings (ลดเส้นซ้อนทับ) ===
left to right direction
skinparam linetype ortho
skinparam nodesep 50
skinparam ranksep 40

skinparam class {
    BackgroundColor White
    BorderColor Black
    ArrowColor Black
}
skinparam package {
    BackgroundColor<<Controller>> #E3F2FD
    BackgroundColor<<Core>> #FFF3E0
    BackgroundColor<<Display>> #E0F7FA
    BackgroundColor<<UI>> #E8F5E9
    BackgroundColor<<Utility>> #F3E5F5
}

' ============================================================================
' CONTROLLERS PACKAGE
' ============================================================================

package "Controllers" <<Controller>> {
    class "script.js" as Script <<Main>> {
        - isTrainingMode: boolean
        - currentPerformanceMode: string
        - -
        + startTrainingFlow()
        + endTrainingSession()
        + onResults(results)
        + loadReferenceData()
        + setPerformanceMode(mode)
        + selectPerformanceMode(mode)
    }
    
    class KeyboardController {
        - deps: object
        - -
        + handleKeydown(event)
        + showShortcutsHelp()
    }
    
    class DisplayController {
        - showGhostOverlay: boolean
        - showPath: boolean
        - showSkeleton: boolean
        - showSilhouette: boolean
        - showTrail: boolean
        - showBlurBackground: boolean
        - showSideBySide: boolean
        - showErrorHighlights: boolean
        - trailHistory: array
        - -
        + init()
        + toggleInstructor(show)
        + resetToDefaults()
        + addTrailPoint(x, y)
        + clearTrail()
        + clearTrail()
        + initBlurBackgroundCheckbox()
        + autoDisableHighCostEffects()
    }
    
    note as NC
        **จัดการ Application Flow**
        Script = Main Controller
        Keyboard = 15 Shortcuts (เพิ่ม K)
        Display = 7 Options (เพิ่ม Blur)
    end note
}

' ============================================================================
' CORE MANAGERS PACKAGE
' ============================================================================

package "Core Managers" <<Core>> {
    class HeuristicsEngine {
        - config: object
        - calibrationData: object
        - -
        + analyze(landmarks): Feedback[]
        + setCalibration(data)
        - checkPathShape()
        - checkElbowSinking()
        - checkContinuity()
        - checkContinuity()
        - checkArmRotation()
        .. +4 more rules ..
    }
    
    class CalibrationManager {
        - isActive: boolean
        - calibrationData: object
        - level: string
        - -
        + start()
        + stop()
        + cancel()
        + process(landmarks)
        + setLevel(level)
        + drawOverlay(ctx)
    }
    
    class ScoringManager {
        - totalFrames: int
        - correctFrames: int
        - -
        + start()
        + recordFrame(feedbacks)
        + getSummary(): object
    }
}

' ============================================================================
' DISPLAY MANAGERS PACKAGE (แยกจาก Core เพราะเป็น View/Render)
' ============================================================================

package "Display Managers" <<Display>> {
    class BackgroundManager {
        - mode: string
        - blurAmount: number
        - backgroundImage: Image
        - -
        + setMode(mode)
        + setBlurAmount(amount)
        + drawBackground(ctx, mask, video, width, height)
    }

    class DrawingManager {
        - ctx: CanvasRenderingContext2D
        - isMirrored: boolean
        - -
        + drawSkeleton(landmarks)
        + drawPath(path, color)
        + drawTrail(history)
        + drawFeedbackPanel(feedbacks)
        + drawDebugOverlay(debugInfo)
        + drawGhostSkeleton(landmarks)
        + drawSilhouetteVideo(video, opacity)
        + drawSilhouette(mask, color)
        + drawGestureFeedback(feedback)
        + drawCircularityIndicator(score)
        + drawErrorHighlights(landmarks, errors)
    }
    
    class GhostManager {
        - isPlaying: boolean
        - opacity: number
        - silhouetteVideo: HTMLVideoElement
        - -
        + load(data)
        + loadSilhouetteVideo(url)
        + start()
        + stop()
        + update()
        + getCurrentFrame()
        + setSpeed(speed)
        + setOpacity(opacity)
    }
    
    ' Force horizontal layout
    DrawingManager -[hidden]right- GhostManager
    GhostManager -[hidden]right- BackgroundManager
}

' ============================================================================
' UI MANAGERS PACKAGE
' ============================================================================

package "UI & Feedback" <<UI>> {
    together {
        class UIManager {
            - currentLang: string
            - currentTheme: string
            - -
            + toggleLanguage()
            + toggleTheme()
            + toggleLanguage()
            + toggleTheme()
            + showNotification(msg)
            + closeAllMenus(exceptId)
        }
        
        class AudioManager {
            - enabled: boolean
            - cooldown: number
            - -
            + speak(message)
            + speakFeedback(feedbacks)
            + waitForIdle(timeout)
            + getExerciseSpokenText(id, level)
        }
        
        class TutorialManager {
            - isOpen: boolean
            - -
            + open(lang)
            + close()
        }
        
        class ScorePopupManager {
            - -
            + show(summary, grade)
            + close()
        }
        
        class RulesConfigManager {
            - -
            + setRuleEnabled(key, enabled)
            + resetToDefaults()
        }
        
        class GestureManager {
            - isReady: boolean
            - -
            + init()
            + detectGestures(video)
        }
        
        class FeedbackManager {
            - formUrl: string
            - -
            + createButton()
            + showPopup()
            + getLang()
        }
    }
    
    ' Force horizontal layout
    UIManager -[hidden]right- AudioManager
    AudioManager -[hidden]right- TutorialManager
    TutorialManager -[hidden]right- ScorePopupManager
    ScorePopupManager -[hidden]right- RulesConfigManager
    RulesConfigManager -[hidden]right- GestureManager
    GestureManager -[hidden]right- FeedbackManager
}

' ============================================================================
' UTILITIES PACKAGE
' ============================================================================

package "Utilities" <<Utility>> {
    together {
        class SessionManager <<Utility>> {
            + getOrCreateUserId()
            + generateSessionId()
        }
        
        class PathGenerator <<Utility>> {
            + generateDynamicPath(landmarks, exercise)
        }
        
        class DataExporter <<Utility>> {
            + exportJSON(data)
            + exportCSV(data)
        }
    }
    
    ' Force horizontal layout
    SessionManager -[hidden]right- PathGenerator
    PathGenerator -[hidden]right- DataExporter
}

' ============================================================================
' RELATIONSHIPS (Simplified - ไม่มี label เพื่อความสะอาด)
' ============================================================================

' Controller relationships
Script - -> KeyboardController
Script - -> DisplayController
Script - -> HeuristicsEngine
Script - -> CalibrationManager
Script - -> DrawingManager
Script - -> BackgroundManager
Script - -> UIManager
Script - -> AudioManager
Script - -> TutorialManager
Script - -> GestureManager

' Display Controller
DisplayController - -> GhostManager
DisplayController - -> BackgroundManager
KeyboardController ..> DisplayController

' Core relationships
HeuristicsEngine ..> CalibrationManager
ScoringManager <.. HeuristicsEngine
DrawingManager <.. HeuristicsEngine

' UI relationships
UIManager - -> ScorePopupManager
ScoringManager .[norank].> ScorePopupManager
Script - -> FeedbackManager
RulesConfigManager - -> HeuristicsEngine

' Utilities (เส้นประ = indirect)
Script ..> SessionManager
Script ..> PathGenerator
Script ..> DataExporter

' ============================================================================
' ARCHITECTURE NOTE
' ============================================================================

note as N1
    **TaijiFlow AI Architecture**
    
    MVC-like Pattern (5 Packages):
    - **Controllers**: script.js + Keyboard + Display
    - **Core**: HeuristicsEngine, Calibration, Scoring
    - **Display**: Drawing, Ghost, Background
    - **UI**: UIManager + 6 more
    - **Utility**: Session, Path, Exporter
    
    Total: 18 Classes, 21 Modules
end note

@enduml

@startuml TaijiFlow_Class_Diagram

skinparam defaultFontName "sarabun"
skinparam packageStyle rectangle

left to right direction
skinparam linetype ortho
skinparam nodesep 50
skinparam ranksep 40

skinparam class {
    BackgroundColor White
    BorderColor Black
    ArrowColor Black
}
skinparam package {
    BackgroundColor<<Controller>> #E3F2FD
    BackgroundColor<<Core>> #FFF3E0
    BackgroundColor<<Display>> #E0F7FA
    BackgroundColor<<UI>> #E8F5E9
    BackgroundColor<<Utility>> #F3E5F5
}


package "Controllers" <<Controller>> {
    class "script.js" as Script <<Main>> {
        - isTrainingMode: boolean
        - currentPerformanceMode: string
        - -
        + startTrainingFlow()
        + endTrainingSession()
        + onResults(results)
        + loadReferenceData()
        + setPerformanceMode(mode)
        + selectPerformanceMode(mode)
    }
    
    class KeyboardController {
        - deps: object
        - -
        + handleKeydown(event)
        + showShortcutsHelp()
    }
    
    class DisplayController {
        - showGhostOverlay: boolean
        - showPath: boolean
        - showSkeleton: boolean
        - showSilhouette: boolean
        - showTrail: boolean
        - showBlurBackground: boolean
        - showSideBySide: boolean
        - showErrorHighlights: boolean
        - trailHistory: array
        - -
        + init()
        + toggleInstructor(show)
        + resetToDefaults()
        + addTrailPoint(x, y)
        + clearTrail()
        + clearTrail()
        + initBlurBackgroundCheckbox()
        + autoDisableHighCostEffects()
    }
    
    note as NC
        **จัดการ Application Flow**
        Script = Main Controller
        Keyboard = 15 Shortcuts (เพิ่ม K)
        Display = 7 Options (เพิ่ม Blur)
    end note
}


package "Core Managers" <<Core>> {
    class HeuristicsEngine {
        - config: object
        - calibrationData: object
        - -
        + analyze(landmarks): Feedback[]
        + setCalibration(data)
        - checkPathShape()
        - checkElbowSinking()
        - checkContinuity()
        - checkContinuity()
        - checkArmRotation()
        .. +4 more rules ..
    }
    
    class CalibrationManager {
        - isActive: boolean
        - calibrationData: object
        - level: string
        - -
        + start()
        + stop()
        + cancel()
        + process(landmarks)
        + setLevel(level)
        + drawOverlay(ctx)
    }
    
    class ScoringManager {
        - totalFrames: int
        - correctFrames: int
        - -
        + start()
        + recordFrame(feedbacks)
        + getSummary(): object
    }
}


package "Display Managers" <<Display>> {
    class BackgroundManager {
        - mode: string
        - blurAmount: number
        - backgroundImage: Image
        - -
        + setMode(mode)
        + setBlurAmount(amount)
        + drawBackground(ctx, mask, video, width, height)
    }

    class DrawingManager {
        - ctx: CanvasRenderingContext2D
        - isMirrored: boolean
        - -
        + drawSkeleton(landmarks)
        + drawPath(path, color)
        + drawTrail(history)
        + drawFeedbackPanel(feedbacks)
        + drawDebugOverlay(debugInfo)
        + drawGhostSkeleton(landmarks)
        + drawSilhouetteVideo(video, opacity)
        + drawSilhouette(mask, color)
        + drawGestureFeedback(feedback)
        + drawCircularityIndicator(score)
        + drawErrorHighlights(landmarks, errors)
    }
    
    class GhostManager {
        - isPlaying: boolean
        - opacity: number
        - silhouetteVideo: HTMLVideoElement
        - -
        + load(data)
        + loadSilhouetteVideo(url)
        + start()
        + stop()
        + update()
        + getCurrentFrame()
        + setSpeed(speed)
        + setOpacity(opacity)
    }
    
    DrawingManager -[hidden]right- GhostManager
    GhostManager -[hidden]right- BackgroundManager
}


package "UI & Feedback" <<UI>> {
    together {
        class UIManager {
            - currentLang: string
            - currentTheme: string
            - -
            + toggleLanguage()
            + toggleTheme()
            + toggleLanguage()
            + toggleTheme()
            + showNotification(msg)
            + closeAllMenus(exceptId)
        }
        
        class AudioManager {
            - enabled: boolean
            - cooldown: number
            - -
            + speak(message)
            + speakFeedback(feedbacks)
            + waitForIdle(timeout)
            + getExerciseSpokenText(id, level)
        }
        
        class TutorialManager {
            - isOpen: boolean
            - -
            + open(lang)
            + close()
        }
        
        class ScorePopupManager {
            - -
            + show(summary, grade)
            + close()
        }
        
        class RulesConfigManager {
            - -
            + setRuleEnabled(key, enabled)
            + resetToDefaults()
        }
        
        class GestureManager {
            - isReady: boolean
            - -
            + init()
            + detectGestures(video)
        }
        
        class FeedbackManager {
            - formUrl: string
            - -
            + createButton()
            + showPopup()
            + getLang()
        }
    }
    
    UIManager -[hidden]right- AudioManager
    AudioManager -[hidden]right- TutorialManager
    TutorialManager -[hidden]right- ScorePopupManager
    ScorePopupManager -[hidden]right- RulesConfigManager
    RulesConfigManager -[hidden]right- GestureManager
    GestureManager -[hidden]right- FeedbackManager
}


package "Utilities" <<Utility>> {
    together {
        class SessionManager <<Utility>> {
            + getOrCreateUserId()
            + generateSessionId()
        }
        
        class PathGenerator <<Utility>> {
            + generateDynamicPath(landmarks, exercise)
        }
        
        class DataExporter <<Utility>> {
            + exportJSON(data)
            + exportCSV(data)
        }
    }
    
    SessionManager -[hidden]right- PathGenerator
    PathGenerator -[hidden]right- DataExporter
}


Script - -> KeyboardController
Script - -> DisplayController
Script - -> HeuristicsEngine
Script - -> CalibrationManager
Script - -> DrawingManager
Script - -> BackgroundManager
Script - -> UIManager
Script - -> AudioManager
Script - -> TutorialManager
Script - -> GestureManager

DisplayController - -> GhostManager
DisplayController - -> BackgroundManager
KeyboardController ..> DisplayController

HeuristicsEngine ..> CalibrationManager
ScoringManager <.. HeuristicsEngine
DrawingManager <.. HeuristicsEngine

UIManager - -> ScorePopupManager
ScoringManager .[norank].> ScorePopupManager
Script - -> FeedbackManager
RulesConfigManager - -> HeuristicsEngine

Script ..> SessionManager
Script ..> PathGenerator
Script ..> DataExporter


note as N1
    **TaijiFlow AI Architecture**
    
    MVC-like Pattern (5 Packages):
    - **Controllers**: script.js + Keyboard + Display
    - **Core**: HeuristicsEngine, Calibration, Scoring
    - **Display**: Drawing, Ghost, Background
    - **UI**: UIManager + 6 more
    - **Utility**: Session, Path, Exporter
    
    Total: 18 Classes, 21 Modules
end note

@enduml

PlantUML version 1.2021.00(Sun Jan 10 17:25:05 ICT 2021)
(MIT source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>