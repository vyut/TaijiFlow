<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1752px" preserveAspectRatio="none" style="width:1523px;height:1752px;" version="1.1" viewBox="0 0 1523 1752" width="1523px" zoomAndPan="magnify"><defs><filter height="300%" id="fc61ddkkbk4fr" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[ed1d20ea533a2a0e7df5ba3c35e56ced]
cluster Controllers--><rect fill="#E3F2FD" filter="url(#fc61ddkkbk4fr)" height="371" style="stroke:#000000;stroke-width:1.5;" width="786.5" x="24.5" y="200.5"/><text fill="#000000" font-family="sarabun" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="76" x="379.75" y="217.452">«Controller»</text><text fill="#000000" font-family="sarabun" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="73" x="381.25" y="235.652">Controllers</text><!--MD5=[1fc7141c6f48660c71a2006c6bf2683f]
cluster Core Managers--><rect fill="#FFF3E0" filter="url(#fc61ddkkbk4fr)" height="269" style="stroke:#000000;stroke-width:1.5;" width="611" x="900" y="1004.5"/><text fill="#000000" font-family="sarabun" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="42" x="1184.5" y="1021.452">«Core»</text><text fill="#000000" font-family="sarabun" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="95" x="1158" y="1039.652">Core Managers</text><!--MD5=[af552435e54b04649ea7481a5d22641b]
cluster Display Managers--><rect fill="#E0F7FA" filter="url(#fc61ddkkbk4fr)" height="759" style="stroke:#000000;stroke-width:1.5;" width="259" x="858" y="221.5"/><text fill="#000000" font-family="sarabun" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="58" x="958.5" y="238.452">«Display»</text><text fill="#000000" font-family="sarabun" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="109" x="933" y="256.652">Display Managers</text><!--MD5=[7ac1916149c3369d001f628ff410a677]
cluster UI & Feedback--><rect fill="#E8F5E9" filter="url(#fc61ddkkbk4fr)" height="618" style="stroke:#000000;stroke-width:1.5;" width="513.5" x="320.5" y="635.5"/><text fill="#000000" font-family="sarabun" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="27" x="563.75" y="652.452">«UI»</text><text fill="#000000" font-family="sarabun" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="91" x="531.75" y="670.652">UI &amp; Feedback</text><!--MD5=[0b7db6fcd588f8499928e45a474751dc]
cluster Utilities--><rect fill="#F3E5F5" filter="url(#fc61ddkkbk4fr)" height="463" style="stroke:#000000;stroke-width:1.5;" width="315" x="294" y="1277.5"/><text fill="#000000" font-family="sarabun" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="49" x="427" y="1294.452">«Utility»</text><text fill="#000000" font-family="sarabun" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="51" x="426" y="1312.652">Utilities</text><!--MD5=[d0d7b0900e371541ba11cbff692d2bc7]
class Script--><rect codeLine="35" fill="#FFFFFF" filter="url(#fc61ddkkbk4fr)" height="171.6" id="Script" style="stroke:#000000;stroke-width:1.5;" width="184" x="50" y="383.7"/><ellipse cx="117.25" cy="404.3" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M119.7231,410.4431 Q119.1421,410.7419 118.5029,410.8913 Q117.8638,411.0407 117.1582,411.0407 Q114.6514,411.0407 113.3315,409.3889 Q112.0117,407.737 112.0117,404.6159 Q112.0117,401.4865 113.3315,399.8347 Q114.6514,398.1828 117.1582,398.1828 Q117.8638,398.1828 118.5112,398.3322 Q119.1587,398.4816 119.7231,398.7805 L119.7231,401.5031 Q119.0923,400.9221 118.4988,400.6523 Q117.9053,400.3825 117.2744,400.3825 Q115.9297,400.3825 115.2449,401.4492 Q114.5601,402.5158 114.5601,404.6159 Q114.5601,406.7077 115.2449,407.7744 Q115.9297,408.841 117.2744,408.841 Q117.9053,408.841 118.4988,408.5712 Q119.0923,408.3015 119.7231,407.7204 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="39" x="138.75" y="401.516">«Main»</text><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="41" x="137.75" y="417.116">script.js</text><line style="stroke:#000000;stroke-width:1.5;" x1="51" x2="233" y1="424.9" y2="424.9"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="58" y="432.9"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="120" x="70" y="440.648">isTrainingMode: boolean</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="58" y="447.2"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="158" x="70" y="454.948">currentPerformanceMode: string</text><line style="stroke:#000000;stroke-width:1.0;" x1="51" x2="233" y1="461.5" y2="461.5"/><ellipse cx="61" cy="472.5" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="91" x="70" y="477.248">startTrainingFlow()</text><ellipse cx="61" cy="486.8" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="101" x="70" y="491.548">endTrainingSession()</text><ellipse cx="61" cy="501.1" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="86" x="70" y="505.848">onResults(results)</text><ellipse cx="61" cy="515.4" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="99" x="70" y="520.148">loadReferenceData()</text><ellipse cx="61" cy="529.7" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="137" x="70" y="534.448">setPerformanceMode(mode)</text><ellipse cx="61" cy="544" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="151" x="70" y="548.748">selectPerformanceMode(mode)</text><!--MD5=[8efddad45aa6a4eb444717d204646b2a]
class KeyboardController--><rect codeLine="47" fill="#FFFFFF" filter="url(#fc61ddkkbk4fr)" height="90.9" id="KeyboardController" style="stroke:#000000;stroke-width:1.5;" width="135" x="384" y="383.05"/><ellipse cx="399" cy="399.05" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M401.4731,405.1931 Q400.8921,405.4919 400.2529,405.6413 Q399.6138,405.7907 398.9082,405.7907 Q396.4014,405.7907 395.0815,404.1389 Q393.7617,402.487 393.7617,399.3659 Q393.7617,396.2365 395.0815,394.5847 Q396.4014,392.9328 398.9082,392.9328 Q399.6138,392.9328 400.2612,393.0822 Q400.9087,393.2316 401.4731,393.5305 L401.4731,396.2531 Q400.8423,395.6721 400.2488,395.4023 Q399.6553,395.1325 399.0244,395.1325 Q397.6797,395.1325 396.9949,396.1992 Q396.3101,397.2658 396.3101,399.3659 Q396.3101,401.4577 396.9949,402.5244 Q397.6797,403.591 399.0244,403.591 Q399.6553,403.591 400.2488,403.3212 Q400.8423,403.0515 401.4731,402.4704 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="103" x="413" y="404.066">KeyboardController</text><line style="stroke:#000000;stroke-width:1.5;" x1="385" x2="518" y1="415.05" y2="415.05"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="392" y="423.05"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="59" x="404" y="430.798">deps: object</text><line style="stroke:#000000;stroke-width:1.0;" x1="385" x2="518" y1="437.35" y2="437.35"/><ellipse cx="395" cy="448.35" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="109" x="404" y="453.098">handleKeydown(event)</text><ellipse cx="395" cy="462.65" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="98" x="404" y="467.398">showShortcutsHelp()</text><!--MD5=[8172fdb26fe0b4f66f8ce07666356cda]
class DisplayController--><rect codeLine="54" fill="#FFFFFF" filter="url(#fc61ddkkbk4fr)" height="262.5" id="DisplayController" style="stroke:#000000;stroke-width:1.5;" width="170" x="625" y="255.25"/><ellipse cx="661.6" cy="271.25" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M664.0731,277.3931 Q663.4921,277.6919 662.8529,277.8413 Q662.2138,277.9907 661.5082,277.9907 Q659.0014,277.9907 657.6815,276.3389 Q656.3617,274.687 656.3617,271.5659 Q656.3617,268.4365 657.6815,266.7847 Q659.0014,265.1328 661.5082,265.1328 Q662.2138,265.1328 662.8612,265.2822 Q663.5087,265.4316 664.0731,265.7305 L664.0731,268.4531 Q663.4423,267.8721 662.8488,267.6023 Q662.2553,267.3325 661.6244,267.3325 Q660.2797,267.3325 659.5949,268.3992 Q658.9101,269.4658 658.9101,271.5659 Q658.9101,273.6577 659.5949,274.7244 Q660.2797,275.791 661.6244,275.791 Q662.2553,275.791 662.8488,275.5212 Q663.4423,275.2515 664.0731,274.6704 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="90" x="680.4" y="276.266">DisplayController</text><line style="stroke:#000000;stroke-width:1.5;" x1="626" x2="794" y1="287.25" y2="287.25"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="633" y="295.25"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="133" x="645" y="302.998">showGhostOverlay: boolean</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="633" y="309.55"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="91" x="645" y="317.298">showPath: boolean</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="633" y="323.85"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="111" x="645" y="331.598">showSkeleton: boolean</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="633" y="338.15"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="119" x="645" y="345.898">showSilhouette: boolean</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="633" y="352.45"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="91" x="645" y="360.198">showTrail: boolean</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="633" y="366.75"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="144" x="645" y="374.498">showBlurBackground: boolean</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="633" y="381.05"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="85" x="645" y="388.798">trailHistory: array</text><line style="stroke:#000000;stroke-width:1.0;" x1="626" x2="794" y1="395.35" y2="395.35"/><ellipse cx="636" cy="406.35" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="22" x="645" y="411.098">init()</text><ellipse cx="636" cy="420.65" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="108" x="645" y="425.398">toggleInstructor(show)</text><ellipse cx="636" cy="434.95" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="84" x="645" y="439.698">resetToDefaults()</text><ellipse cx="636" cy="449.25" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="87" x="645" y="453.998">addTrailPoint(x, y)</text><ellipse cx="636" cy="463.55" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="52" x="645" y="468.298">clearTrail()</text><ellipse cx="636" cy="477.85" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="52" x="645" y="482.598">clearTrail()</text><ellipse cx="636" cy="492.15" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="142" x="645" y="496.898">initBlurBackgroundCheckbox()</text><ellipse cx="636" cy="506.45" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="141" x="645" y="511.198">autoDisableHighCostEffects()</text><path d="M40.5,255.7 L40.5,333.3 L243.5,333.3 L243.5,265.7 L233.5,255.7 L40.5,255.7 " fill="#FBFB77" filter="url(#fc61ddkkbk4fr)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M233.5,255.7 L233.5,265.7 L243.5,265.7 L233.5,255.7 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="137" x="46.5" y="274.584">จัดการ Application Flow</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="136" x="46.5" y="291.484">Script = Main Controller</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="182" x="46.5" y="308.384">Keyboard = 15 Shortcuts (เพิ่ม K)</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="166" x="46.5" y="325.284">Display = 7 Options (เพิ่ม Blur)</text><!--MD5=[acf674d2eee96cced2a8b22730b1989e]
class HeuristicsEngine--><rect codeLine="86" fill="#FFFFFF" filter="url(#fc61ddkkbk4fr)" height="198.15" id="HeuristicsEngine" style="stroke:#000000;stroke-width:1.5;" width="177" x="1141" y="1059.43"/><ellipse cx="1181.65" cy="1075.43" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M1184.1231,1081.5731 Q1183.5421,1081.8719 1182.9029,1082.0213 Q1182.2638,1082.1707 1181.5582,1082.1707 Q1179.0514,1082.1707 1177.7315,1080.5189 Q1176.4117,1078.867 1176.4117,1075.7459 Q1176.4117,1072.6165 1177.7315,1070.9647 Q1179.0514,1069.3128 1181.5582,1069.3128 Q1182.2638,1069.3128 1182.9112,1069.4622 Q1183.5587,1069.6116 1184.1231,1069.9105 L1184.1231,1072.6331 Q1183.4923,1072.0521 1182.8988,1071.7823 Q1182.3053,1071.5125 1181.6744,1071.5125 Q1180.3297,1071.5125 1179.6449,1072.5792 Q1178.9601,1073.6458 1178.9601,1075.7459 Q1178.9601,1077.8377 1179.6449,1078.9044 Q1180.3297,1079.971 1181.6744,1079.971 Q1182.3053,1079.971 1182.8988,1079.7012 Q1183.4923,1079.4315 1184.1231,1078.8504 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="88" x="1201.35" y="1080.446">HeuristicsEngine</text><line style="stroke:#000000;stroke-width:1.5;" x1="1142" x2="1317" y1="1091.43" y2="1091.43"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1149" y="1099.43"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="66" x="1161" y="1107.178">config: object</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1149" y="1113.73"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="111" x="1161" y="1121.478">calibrationData: object</text><line style="stroke:#000000;stroke-width:1.0;" x1="1142" x2="1317" y1="1128.03" y2="1128.03"/><ellipse cx="1152" cy="1139.03" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="151" x="1161" y="1143.778">analyze(landmarks): Feedback[]</text><ellipse cx="1152" cy="1153.33" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="96" x="1161" y="1158.078">setCalibration(data)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1149" y="1164.63"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="85" x="1161" y="1172.378">checkPathShape()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1149" y="1178.93"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="96" x="1161" y="1186.678">checkElbowSinking()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1149" y="1193.23"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="82" x="1161" y="1200.978">checkContinuity()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1149" y="1207.53"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="82" x="1161" y="1215.278">checkContinuity()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1149" y="1221.83"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="94" x="1161" y="1229.578">checkArmRotation()</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:1.0,2.0;" x1="1142" x2="1195.5" y1="1243.28" y2="1243.28"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="68" x="1195.5" y="1247.378">+4 more rules</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:1.0,2.0;" x1="1263.5" x2="1317" y1="1243.28" y2="1243.28"/><!--MD5=[2695471b11f4afe9b2f935479e6afc73]
class CalibrationManager--><rect codeLine="100" fill="#FFFFFF" filter="url(#fc61ddkkbk4fr)" height="176.7" id="CalibrationManager" style="stroke:#000000;stroke-width:1.5;" width="137" x="1358" y="1076.15"/><ellipse cx="1373.9" cy="1092.15" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M1376.3731,1098.2931 Q1375.7921,1098.5919 1375.1529,1098.7413 Q1374.5138,1098.8907 1373.8082,1098.8907 Q1371.3014,1098.8907 1369.9815,1097.2389 Q1368.6617,1095.587 1368.6617,1092.4659 Q1368.6617,1089.3365 1369.9815,1087.6847 Q1371.3014,1086.0328 1373.8082,1086.0328 Q1374.5138,1086.0328 1375.1612,1086.1822 Q1375.8087,1086.3316 1376.3731,1086.6305 L1376.3731,1089.3531 Q1375.7423,1088.7721 1375.1488,1088.5023 Q1374.5553,1088.2325 1373.9244,1088.2325 Q1372.5797,1088.2325 1371.8949,1089.2992 Q1371.2101,1090.3658 1371.2101,1092.4659 Q1371.2101,1094.5577 1371.8949,1095.6244 Q1372.5797,1096.691 1373.9244,1096.691 Q1374.5553,1096.691 1375.1488,1096.4212 Q1375.7423,1096.1515 1376.3731,1095.5704 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="103" x="1388.1" y="1097.166">CalibrationManager</text><line style="stroke:#000000;stroke-width:1.5;" x1="1359" x2="1494" y1="1108.15" y2="1108.15"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1366" y="1116.15"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="83" x="1378" y="1123.898">isActive: boolean</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1366" y="1130.45"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="111" x="1378" y="1138.198">calibrationData: object</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="1366" y="1144.75"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="57" x="1378" y="1152.498">level: string</text><line style="stroke:#000000;stroke-width:1.0;" x1="1359" x2="1494" y1="1159.05" y2="1159.05"/><ellipse cx="1369" cy="1170.05" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="29" x="1378" y="1174.798">start()</text><ellipse cx="1369" cy="1184.35" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="27" x="1378" y="1189.098">stop()</text><ellipse cx="1369" cy="1198.65" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="37" x="1378" y="1203.398">cancel()</text><ellipse cx="1369" cy="1212.95" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="93" x="1378" y="1217.698">process(landmarks)</text><ellipse cx="1369" cy="1227.25" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="70" x="1378" y="1231.998">setLevel(level)</text><ellipse cx="1369" cy="1241.55" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="79" x="1378" y="1246.298">drawOverlay(ctx)</text><!--MD5=[49faa9a638d20fb09fbea4482760b511]
class ScoringManager--><rect codeLine="113" fill="#FFFFFF" filter="url(#fc61ddkkbk4fr)" height="119.5" id="ScoringManager" style="stroke:#000000;stroke-width:1.5;" width="143" x="916" y="1124.75"/><ellipse cx="943.15" cy="1140.75" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M945.6231,1146.8931 Q945.0421,1147.1919 944.4029,1147.3413 Q943.7638,1147.4907 943.0582,1147.4907 Q940.5514,1147.4907 939.2315,1145.8389 Q937.9117,1144.187 937.9117,1141.0659 Q937.9117,1137.9365 939.2315,1136.2847 Q940.5514,1134.6328 943.0582,1134.6328 Q943.7638,1134.6328 944.4112,1134.7822 Q945.0587,1134.9316 945.6231,1135.2305 L945.6231,1137.9531 Q944.9923,1137.3721 944.3988,1137.1023 Q943.8053,1136.8325 943.1744,1136.8325 Q941.8297,1136.8325 941.1449,1137.8992 Q940.4601,1138.9658 940.4601,1141.0659 Q940.4601,1143.1577 941.1449,1144.2244 Q941.8297,1145.291 943.1744,1145.291 Q943.8053,1145.291 944.3988,1145.0212 Q944.9923,1144.7515 945.6231,1144.1704 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="84" x="959.85" y="1145.766">ScoringManager</text><line style="stroke:#000000;stroke-width:1.5;" x1="917" x2="1058" y1="1156.75" y2="1156.75"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="924" y="1164.75"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="78" x="936" y="1172.498">totalFrames: int</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="924" y="1179.05"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="89" x="936" y="1186.798">correctFrames: int</text><line style="stroke:#000000;stroke-width:1.0;" x1="917" x2="1058" y1="1193.35" y2="1193.35"/><ellipse cx="927" cy="1204.35" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="29" x="936" y="1209.098">start()</text><ellipse cx="927" cy="1218.65" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="117" x="936" y="1223.398">recordFrame(feedbacks)</text><ellipse cx="927" cy="1232.95" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="103" x="936" y="1237.698">getSummary(): object</text><!--MD5=[7065e7be84ffd0ebe64c11e25c182e37]
class DrawingManager--><rect codeLine="128" fill="#FFFFFF" filter="url(#fc61ddkkbk4fr)" height="233.9" id="DrawingManager" style="stroke:#000000;stroke-width:1.5;" width="227" x="874" y="730.55"/><ellipse cx="940.25" cy="746.55" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M942.7231,752.6931 Q942.1421,752.9919 941.5029,753.1413 Q940.8638,753.2907 940.1582,753.2907 Q937.6514,753.2907 936.3315,751.6389 Q935.0117,749.987 935.0117,746.8659 Q935.0117,743.7365 936.3315,742.0847 Q937.6514,740.4328 940.1582,740.4328 Q940.8638,740.4328 941.5112,740.5822 Q942.1587,740.7316 942.7231,741.0305 L942.7231,743.7531 Q942.0923,743.1721 941.4988,742.9023 Q940.9053,742.6325 940.2744,742.6325 Q938.9297,742.6325 938.2449,743.6992 Q937.5601,744.7658 937.5601,746.8659 Q937.5601,748.9577 938.2449,750.0244 Q938.9297,751.091 940.2744,751.091 Q940.9053,751.091 941.4988,750.8212 Q942.0923,750.5515 942.7231,749.9704 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="86" x="960.75" y="751.566">DrawingManager</text><line style="stroke:#000000;stroke-width:1.5;" x1="875" x2="1100" y1="762.55" y2="762.55"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="882" y="770.55"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="153" x="894" y="778.298">ctx: CanvasRenderingContext2D</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="882" y="784.85"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="95" x="894" y="792.598">isMirrored: boolean</text><line style="stroke:#000000;stroke-width:1.0;" x1="875" x2="1100" y1="799.15" y2="799.15"/><ellipse cx="885" cy="810.15" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="121" x="894" y="814.898">drawSkeleton(landmarks)</text><ellipse cx="885" cy="824.45" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="103" x="894" y="829.198">drawPath(path, color)</text><ellipse cx="885" cy="838.75" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="84" x="894" y="843.498">drawTrail(history)</text><ellipse cx="885" cy="853.05" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="151" x="894" y="857.798">drawFeedbackPanel(feedbacks)</text><ellipse cx="885" cy="867.35" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="145" x="894" y="872.098">drawDebugOverlay(debugInfo)</text><ellipse cx="885" cy="881.65" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="149" x="894" y="886.398">drawGhostSkeleton(landmarks)</text><ellipse cx="885" cy="895.95" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="174" x="894" y="900.698">drawSilhouetteVideo(video, opacity)</text><ellipse cx="885" cy="910.25" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="134" x="894" y="914.998">drawSilhouette(mask, color)</text><ellipse cx="885" cy="924.55" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="157" x="894" y="929.298">drawGestureFeedback(feedback)</text><ellipse cx="885" cy="938.85" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="147" x="894" y="943.598">drawCircularityIndicator(score)</text><ellipse cx="885" cy="953.15" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="201" x="894" y="957.898">drawBlurredBackground(ctx, image, mask)</text><!--MD5=[27430a77e3018f6a78460c75ee8741e0]
class GhostManager--><rect codeLine="145" fill="#FFFFFF" filter="url(#fc61ddkkbk4fr)" height="219.6" id="GhostManager" style="stroke:#000000;stroke-width:1.5;" width="205" x="885" y="276.7"/><ellipse cx="944.75" cy="292.7" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M947.2231,298.8431 Q946.6421,299.1419 946.0029,299.2913 Q945.3638,299.4407 944.6582,299.4407 Q942.1514,299.4407 940.8315,297.7889 Q939.5117,296.137 939.5117,293.0159 Q939.5117,289.8865 940.8315,288.2347 Q942.1514,286.5828 944.6582,286.5828 Q945.3638,286.5828 946.0112,286.7322 Q946.6587,286.8816 947.2231,287.1805 L947.2231,289.9031 Q946.5923,289.3221 945.9988,289.0523 Q945.4053,288.7825 944.7744,288.7825 Q943.4297,288.7825 942.7449,289.8492 Q942.0601,290.9158 942.0601,293.0159 Q942.0601,295.1077 942.7449,296.1744 Q943.4297,297.241 944.7744,297.241 Q945.4053,297.241 945.9988,296.9712 Q946.5923,296.7015 947.2231,296.1204 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="77" x="965.25" y="297.716">GhostManager</text><line style="stroke:#000000;stroke-width:1.5;" x1="886" x2="1089" y1="308.7" y2="308.7"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="893" y="316.7"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="88" x="905" y="324.448">isPlaying: boolean</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="893" y="331"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="78" x="905" y="338.748">opacity: number</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="893" y="345.3"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="179" x="905" y="353.048">silhouetteVideo: HTMLVideoElement</text><line style="stroke:#000000;stroke-width:1.0;" x1="886" x2="1089" y1="359.6" y2="359.6"/><ellipse cx="896" cy="370.6" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="49" x="905" y="375.348">load(data)</text><ellipse cx="896" cy="384.9" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="118" x="905" y="389.648">loadSilhouetteVideo(url)</text><ellipse cx="896" cy="399.2" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="29" x="905" y="403.948">start()</text><ellipse cx="896" cy="413.5" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="27" x="905" y="418.248">stop()</text><ellipse cx="896" cy="427.8" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="40" x="905" y="432.548">update()</text><ellipse cx="896" cy="442.1" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="40" x="905" y="446.848">update()</text><ellipse cx="896" cy="456.4" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="89" x="905" y="461.148">getCurrentFrame()</text><ellipse cx="896" cy="470.7" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="80" x="905" y="475.448">setSpeed(speed)</text><ellipse cx="896" cy="485" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="92" x="905" y="489.748">setOpacity(opacity)</text><!--MD5=[6806bdef0702a1d9cf2b16e2b3cf84cb]
class SilhouetteManager--><rect codeLine="161" fill="#FFFFFF" filter="url(#fc61ddkkbk4fr)" height="133.8" id="SilhouetteManager" style="stroke:#000000;stroke-width:1.5;" width="200" x="887.5" y="546.6"/><ellipse cx="933.25" cy="562.6" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M935.7231,568.7431 Q935.1421,569.0419 934.5029,569.1913 Q933.8638,569.3407 933.1582,569.3407 Q930.6514,569.3407 929.3315,567.6889 Q928.0117,566.037 928.0117,562.9159 Q928.0117,559.7865 929.3315,558.1347 Q930.6514,556.4828 933.1582,556.4828 Q933.8638,556.4828 934.5112,556.6322 Q935.1587,556.7816 935.7231,557.0805 L935.7231,559.8031 Q935.0923,559.2221 934.4988,558.9523 Q933.9053,558.6825 933.2744,558.6825 Q931.9297,558.6825 931.2449,559.7492 Q930.5601,560.8158 930.5601,562.9159 Q930.5601,565.0077 931.2449,566.0744 Q931.9297,567.141 933.2744,567.141 Q933.9053,567.141 934.4988,566.8712 Q935.0923,566.6015 935.7231,566.0204 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="100" x="953.75" y="567.616">SilhouetteManager</text><line style="stroke:#000000;stroke-width:1.5;" x1="888.5" x2="1086.5" y1="578.6" y2="578.6"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="895.5" y="586.6"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="92" x="907.5" y="594.348">isEnabled: boolean</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="895.5" y="600.9"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="58" x="907.5" y="608.648">color: string</text><line style="stroke:#000000;stroke-width:1.0;" x1="888.5" x2="1086.5" y1="615.2" y2="615.2"/><ellipse cx="898.5" cy="626.2" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="39" x="907.5" y="630.948">enable()</text><ellipse cx="898.5" cy="640.5" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="41" x="907.5" y="645.248">disable()</text><ellipse cx="898.5" cy="654.8" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="37" x="907.5" y="659.548">toggle()</text><ellipse cx="898.5" cy="669.1" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="174" x="907.5" y="673.848">drawSilhouetteFromMask(ctx, mask)</text><!--MD5=[d602b77267d5088762cb6a59b8ed96b1]
class UIManager--><rect codeLine="182" fill="#FFFFFF" filter="url(#fc61ddkkbk4fr)" height="162.4" id="UIManager" style="stroke:#000000;stroke-width:1.5;" width="143" x="380" y="1051.3"/><ellipse cx="419.3" cy="1067.3" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M421.7731,1073.4431 Q421.1921,1073.7419 420.5529,1073.8913 Q419.9138,1074.0407 419.2082,1074.0407 Q416.7014,1074.0407 415.3815,1072.3889 Q414.0617,1070.737 414.0617,1067.6159 Q414.0617,1064.4865 415.3815,1062.8347 Q416.7014,1061.1828 419.2082,1061.1828 Q419.9138,1061.1828 420.5612,1061.3322 Q421.2087,1061.4816 421.7731,1061.7805 L421.7731,1064.5031 Q421.1423,1063.9221 420.5488,1063.6523 Q419.9553,1063.3825 419.3244,1063.3825 Q417.9797,1063.3825 417.2949,1064.4492 Q416.6101,1065.5158 416.6101,1067.6159 Q416.6101,1069.7077 417.2949,1070.7744 Q417.9797,1071.841 419.3244,1071.841 Q419.9553,1071.841 420.5488,1071.5712 Q421.1423,1071.3015 421.7731,1070.7204 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="57" x="438.7" y="1072.316">UIManager</text><line style="stroke:#000000;stroke-width:1.5;" x1="381" x2="522" y1="1083.3" y2="1083.3"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="388" y="1091.3"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="93" x="400" y="1099.048">currentLang: string</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="388" y="1105.6"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="102" x="400" y="1113.348">currentTheme: string</text><line style="stroke:#000000;stroke-width:1.0;" x1="381" x2="522" y1="1119.9" y2="1119.9"/><ellipse cx="391" cy="1130.9" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="85" x="400" y="1135.648">toggleLanguage()</text><ellipse cx="391" cy="1145.2" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="70" x="400" y="1149.948">toggleTheme()</text><ellipse cx="391" cy="1159.5" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="85" x="400" y="1164.248">toggleLanguage()</text><ellipse cx="391" cy="1173.8" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="70" x="400" y="1178.548">toggleTheme()</text><ellipse cx="391" cy="1188.1" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="108" x="400" y="1192.848">showNotification(msg)</text><ellipse cx="391" cy="1202.4" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="117" x="400" y="1207.148">closeAllMenus(exceptId)</text><!--MD5=[347a6de240a7e533fe3f585d0ed7a7fe]
class AudioManager--><rect codeLine="194" fill="#FFFFFF" filter="url(#fc61ddkkbk4fr)" height="133.8" id="AudioManager" style="stroke:#000000;stroke-width:1.5;" width="182" x="360.5" y="867.6"/><ellipse cx="409.25" cy="883.6" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M411.7231,889.7431 Q411.1421,890.0419 410.5029,890.1913 Q409.8638,890.3407 409.1582,890.3407 Q406.6514,890.3407 405.3315,888.6889 Q404.0117,887.037 404.0117,883.9159 Q404.0117,880.7865 405.3315,879.1347 Q406.6514,877.4828 409.1582,877.4828 Q409.8638,877.4828 410.5112,877.6322 Q411.1587,877.7816 411.7231,878.0805 L411.7231,880.8031 Q411.0923,880.2221 410.4988,879.9523 Q409.9053,879.6825 409.2744,879.6825 Q407.9297,879.6825 407.2449,880.7492 Q406.5601,881.8158 406.5601,883.9159 Q406.5601,886.0077 407.2449,887.0744 Q407.9297,888.141 409.2744,888.141 Q409.9053,888.141 410.4988,887.8712 Q411.0923,887.6015 411.7231,887.0204 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="76" x="429.75" y="888.616">AudioManager</text><line style="stroke:#000000;stroke-width:1.5;" x1="361.5" x2="541.5" y1="899.6" y2="899.6"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="368.5" y="907.6"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="84" x="380.5" y="915.348">enabled: boolean</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="368.5" y="921.9"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="88" x="380.5" y="929.648">cooldown: number</text><line style="stroke:#000000;stroke-width:1.0;" x1="361.5" x2="541.5" y1="936.2" y2="936.2"/><ellipse cx="371.5" cy="947.2" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="77" x="380.5" y="951.948">speak(message)</text><ellipse cx="371.5" cy="961.5" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="129" x="380.5" y="966.248">speakFeedback(feedbacks)</text><ellipse cx="371.5" cy="975.8" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="98" x="380.5" y="980.548">waitForIdle(timeout)</text><ellipse cx="371.5" cy="990.1" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="156" x="380.5" y="994.848">getExerciseSpokenText(id, level)</text><!--MD5=[1dd07b0d44aee610d043a0002d5988d9]
class TutorialManager--><rect codeLine="204" fill="#FFFFFF" filter="url(#fc61ddkkbk4fr)" height="90.9" id="TutorialManager" style="stroke:#000000;stroke-width:1.5;" width="119" x="392" y="727.05"/><ellipse cx="407" cy="743.05" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M409.4731,749.1931 Q408.8921,749.4919 408.2529,749.6413 Q407.6138,749.7907 406.9082,749.7907 Q404.4014,749.7907 403.0815,748.1389 Q401.7617,746.487 401.7617,743.3659 Q401.7617,740.2365 403.0815,738.5847 Q404.4014,736.9328 406.9082,736.9328 Q407.6138,736.9328 408.2612,737.0822 Q408.9087,737.2316 409.4731,737.5305 L409.4731,740.2531 Q408.8423,739.6721 408.2488,739.4023 Q407.6553,739.1325 407.0244,739.1325 Q405.6797,739.1325 404.9949,740.1992 Q404.3101,741.2658 404.3101,743.3659 Q404.3101,745.4577 404.9949,746.5244 Q405.6797,747.591 407.0244,747.591 Q407.6553,747.591 408.2488,747.3212 Q408.8423,747.0515 409.4731,746.4704 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="87" x="421" y="748.066">TutorialManager</text><line style="stroke:#000000;stroke-width:1.5;" x1="393" x2="510" y1="759.05" y2="759.05"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="400" y="767.05"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="78" x="412" y="774.798">isOpen: boolean</text><line style="stroke:#000000;stroke-width:1.0;" x1="393" x2="510" y1="781.35" y2="781.35"/><ellipse cx="403" cy="792.35" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="51" x="412" y="797.098">open(lang)</text><ellipse cx="403" cy="806.65" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="31" x="412" y="811.398">close()</text><!--MD5=[1027430669dbe09cf3ac84b359d871ec]
class ScorePopupManager--><rect codeLine="211" fill="#FFFFFF" filter="url(#fc61ddkkbk4fr)" height="76.6" id="ScorePopupManager" style="stroke:#000000;stroke-width:1.5;" width="141" x="639.5" y="1137.2"/><ellipse cx="654.5" cy="1153.2" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M656.9731,1159.3431 Q656.3921,1159.6419 655.7529,1159.7913 Q655.1138,1159.9407 654.4082,1159.9407 Q651.9014,1159.9407 650.5815,1158.2889 Q649.2617,1156.637 649.2617,1153.5159 Q649.2617,1150.3865 650.5815,1148.7347 Q651.9014,1147.0828 654.4082,1147.0828 Q655.1138,1147.0828 655.7612,1147.2322 Q656.4087,1147.3816 656.9731,1147.6805 L656.9731,1150.4031 Q656.3423,1149.8221 655.7488,1149.5523 Q655.1553,1149.2825 654.5244,1149.2825 Q653.1797,1149.2825 652.4949,1150.3492 Q651.8101,1151.4158 651.8101,1153.5159 Q651.8101,1155.6077 652.4949,1156.6744 Q653.1797,1157.741 654.5244,1157.741 Q655.1553,1157.741 655.7488,1157.4712 Q656.3423,1157.2015 656.9731,1156.6204 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="109" x="668.5" y="1158.216">ScorePopupManager</text><line style="stroke:#000000;stroke-width:1.5;" x1="640.5" x2="779.5" y1="1169.2" y2="1169.2"/><line style="stroke:#000000;stroke-width:1.0;" x1="640.5" x2="779.5" y1="1177.2" y2="1177.2"/><ellipse cx="650.5" cy="1188.2" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="108" x="659.5" y="1192.948">show(summary, grade)</text><ellipse cx="650.5" cy="1202.5" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="31" x="659.5" y="1207.248">close()</text><!--MD5=[ca58359f07f9a4065c7e5ec85443e727]
class RulesConfigManager--><rect codeLine="217" fill="#FFFFFF" filter="url(#fc61ddkkbk4fr)" height="76.6" id="RulesConfigManager" style="stroke:#000000;stroke-width:1.5;" width="168" x="626" y="1010.2"/><ellipse cx="654.05" cy="1026.2" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M656.5231,1032.3431 Q655.9421,1032.6419 655.3029,1032.7913 Q654.6638,1032.9407 653.9582,1032.9407 Q651.4514,1032.9407 650.1315,1031.2889 Q648.8117,1029.637 648.8117,1026.5159 Q648.8117,1023.3865 650.1315,1021.7347 Q651.4514,1020.0828 653.9582,1020.0828 Q654.6638,1020.0828 655.3112,1020.2322 Q655.9587,1020.3816 656.5231,1020.6805 L656.5231,1023.4031 Q655.8923,1022.8221 655.2988,1022.5523 Q654.7053,1022.2825 654.0744,1022.2825 Q652.7297,1022.2825 652.0449,1023.3492 Q651.3601,1024.4158 651.3601,1026.5159 Q651.3601,1028.6077 652.0449,1029.6744 Q652.7297,1030.741 654.0744,1030.741 Q654.7053,1030.741 655.2988,1030.4712 Q655.8923,1030.2015 656.5231,1029.6204 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="107" x="670.95" y="1031.216">RulesConfigManager</text><line style="stroke:#000000;stroke-width:1.5;" x1="627" x2="793" y1="1042.2" y2="1042.2"/><line style="stroke:#000000;stroke-width:1.0;" x1="627" x2="793" y1="1050.2" y2="1050.2"/><ellipse cx="637" cy="1061.2" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="142" x="646" y="1065.948">setRuleEnabled(key, enabled)</text><ellipse cx="637" cy="1075.5" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="84" x="646" y="1080.248">resetToDefaults()</text><!--MD5=[45ce707b976a738d2e4595cad6afaa40]
class GestureManager--><rect codeLine="223" fill="#FFFFFF" filter="url(#fc61ddkkbk4fr)" height="90.9" id="GestureManager" style="stroke:#000000;stroke-width:1.5;" width="132" x="644" y="714.05"/><ellipse cx="665.3" cy="730.05" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M667.7731,736.1931 Q667.1921,736.4919 666.5529,736.6413 Q665.9138,736.7907 665.2082,736.7907 Q662.7014,736.7907 661.3815,735.1389 Q660.0617,733.487 660.0617,730.3659 Q660.0617,727.2365 661.3815,725.5847 Q662.7014,723.9328 665.2082,723.9328 Q665.9138,723.9328 666.5612,724.0822 Q667.2087,724.2316 667.7731,724.5305 L667.7731,727.2531 Q667.1423,726.6721 666.5488,726.4023 Q665.9553,726.1325 665.3244,726.1325 Q663.9797,726.1325 663.2949,727.1992 Q662.6101,728.2658 662.6101,730.3659 Q662.6101,732.4577 663.2949,733.5244 Q663.9797,734.591 665.3244,734.591 Q665.9553,734.591 666.5488,734.3212 Q667.1423,734.0515 667.7731,733.4704 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="86" x="680.7" y="735.066">GestureManager</text><line style="stroke:#000000;stroke-width:1.5;" x1="645" x2="775" y1="746.05" y2="746.05"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="652" y="754.05"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="82" x="664" y="761.798">isReady: boolean</text><line style="stroke:#000000;stroke-width:1.0;" x1="645" x2="775" y1="768.35" y2="768.35"/><ellipse cx="655" cy="779.35" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="22" x="664" y="784.098">init()</text><ellipse cx="655" cy="793.65" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="106" x="664" y="798.398">detectGestures(video)</text><!--MD5=[a53eb7802fcf6e4afed3783382088263]
class FeedbackManager--><rect codeLine="230" fill="#FFFFFF" filter="url(#fc61ddkkbk4fr)" height="105.2" id="FeedbackManager" style="stroke:#000000;stroke-width:1.5;" width="128" x="646" y="854.9"/><ellipse cx="661" cy="870.9" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M663.4731,877.0431 Q662.8921,877.3419 662.2529,877.4913 Q661.6138,877.6407 660.9082,877.6407 Q658.4014,877.6407 657.0815,875.9889 Q655.7617,874.337 655.7617,871.2159 Q655.7617,868.0865 657.0815,866.4347 Q658.4014,864.7828 660.9082,864.7828 Q661.6138,864.7828 662.2612,864.9322 Q662.9087,865.0816 663.4731,865.3805 L663.4731,868.1031 Q662.8423,867.5221 662.2488,867.2523 Q661.6553,866.9825 661.0244,866.9825 Q659.6797,866.9825 658.9949,868.0492 Q658.3101,869.1158 658.3101,871.2159 Q658.3101,873.3077 658.9949,874.3744 Q659.6797,875.441 661.0244,875.441 Q661.6553,875.441 662.2488,875.1712 Q662.8423,874.9015 663.4731,874.3204 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="96" x="675" y="875.916">FeedbackManager</text><line style="stroke:#000000;stroke-width:1.5;" x1="647" x2="773" y1="886.9" y2="886.9"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="654" y="894.9"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="71" x="666" y="902.648">formUrl: string</text><line style="stroke:#000000;stroke-width:1.0;" x1="647" x2="773" y1="909.2" y2="909.2"/><ellipse cx="657" cy="920.2" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="69" x="666" y="924.948">createButton()</text><ellipse cx="657" cy="934.5" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="60" x="666" y="939.248">showPopup()</text><ellipse cx="657" cy="948.8" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="46" x="666" y="953.548">getLang()</text><!--MD5=[f097a9da547c6f19ba7a5c97c093eb18]
class SessionManager--><rect codeLine="254" fill="#FFFFFF" filter="url(#fc61ddkkbk4fr)" height="85.8" id="SessionManager" style="stroke:#000000;stroke-width:1.5;" width="122" x="390.5" y="1614.6"/><ellipse cx="408.2" cy="1635.2" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M410.6731,1641.3431 Q410.0921,1641.6419 409.4529,1641.7913 Q408.8138,1641.9407 408.1082,1641.9407 Q405.6014,1641.9407 404.2815,1640.2889 Q402.9617,1638.637 402.9617,1635.5159 Q402.9617,1632.3865 404.2815,1630.7347 Q405.6014,1629.0828 408.1082,1629.0828 Q408.8138,1629.0828 409.4612,1629.2322 Q410.1087,1629.3816 410.6731,1629.6805 L410.6731,1632.4031 Q410.0423,1631.8221 409.4488,1631.5523 Q408.8553,1631.2825 408.2244,1631.2825 Q406.8797,1631.2825 406.1949,1632.3492 Q405.5101,1633.4158 405.5101,1635.5159 Q405.5101,1637.6077 406.1949,1638.6744 Q406.8797,1639.741 408.2244,1639.741 Q408.8553,1639.741 409.4488,1639.4712 Q410.0423,1639.2015 410.6731,1638.6204 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="45" x="442.3" y="1632.416">«Utility»</text><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="84" x="422.8" y="1648.016">SessionManager</text><line style="stroke:#000000;stroke-width:1.5;" x1="391.5" x2="511.5" y1="1655.8" y2="1655.8"/><line style="stroke:#000000;stroke-width:1.5;" x1="391.5" x2="511.5" y1="1663.8" y2="1663.8"/><ellipse cx="401.5" cy="1674.8" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="96" x="410.5" y="1679.548">getOrCreateUserId()</text><ellipse cx="401.5" cy="1689.1" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="96" x="410.5" y="1693.848">generateSessionId()</text><!--MD5=[cbfd515719b6910b093ca89747820c68]
class PathGenerator--><rect codeLine="259" fill="#FFFFFF" filter="url(#fc61ddkkbk4fr)" height="71.5" id="PathGenerator" style="stroke:#000000;stroke-width:1.5;" width="235" x="334" y="1492.75"/><ellipse cx="408.25" cy="1513.35" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M410.7231,1519.4931 Q410.1421,1519.7919 409.5029,1519.9413 Q408.8638,1520.0907 408.1582,1520.0907 Q405.6514,1520.0907 404.3315,1518.4389 Q403.0117,1516.787 403.0117,1513.6659 Q403.0117,1510.5365 404.3315,1508.8847 Q405.6514,1507.2328 408.1582,1507.2328 Q408.8638,1507.2328 409.5112,1507.3822 Q410.1587,1507.5316 410.7231,1507.8305 L410.7231,1510.5531 Q410.0923,1509.9721 409.4988,1509.7023 Q408.9053,1509.4325 408.2744,1509.4325 Q406.9297,1509.4325 406.2449,1510.4992 Q405.5601,1511.5658 405.5601,1513.6659 Q405.5601,1515.7577 406.2449,1516.8244 Q406.9297,1517.891 408.2744,1517.891 Q408.9053,1517.891 409.4988,1517.6212 Q410.0923,1517.3515 410.7231,1516.7704 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="45" x="445.25" y="1510.566">«Utility»</text><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="78" x="428.75" y="1526.166">PathGenerator</text><line style="stroke:#000000;stroke-width:1.5;" x1="335" x2="568" y1="1533.95" y2="1533.95"/><line style="stroke:#000000;stroke-width:1.5;" x1="335" x2="568" y1="1541.95" y2="1541.95"/><ellipse cx="345" cy="1552.95" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="209" x="354" y="1557.698">generateDynamicPath(landmarks, exercise)</text><!--MD5=[e219136ea99e406b0a84800811d2e145]
class DataExporter--><rect codeLine="263" fill="#FFFFFF" filter="url(#fc61ddkkbk4fr)" height="85.8" id="DataExporter" style="stroke:#000000;stroke-width:1.5;" width="111" x="396" y="1356.6"/><ellipse cx="415.05" cy="1377.2" fill="#ADD1B2" rx="11" ry="11" style="stroke:#000000;stroke-width:1.0;"/><path d="M417.5231,1383.3431 Q416.9421,1383.6419 416.3029,1383.7913 Q415.6638,1383.9407 414.9582,1383.9407 Q412.4514,1383.9407 411.1315,1382.2889 Q409.8117,1380.637 409.8117,1377.5159 Q409.8117,1374.3865 411.1315,1372.7347 Q412.4514,1371.0828 414.9582,1371.0828 Q415.6638,1371.0828 416.3112,1371.2322 Q416.9587,1371.3816 417.5231,1371.6805 L417.5231,1374.4031 Q416.8923,1373.8221 416.2988,1373.5523 Q415.7053,1373.2825 415.0744,1373.2825 Q413.7297,1373.2825 413.0449,1374.3492 Q412.3601,1375.4158 412.3601,1377.5159 Q412.3601,1379.6077 413.0449,1380.6744 Q413.7297,1381.741 415.0744,1381.741 Q415.7053,1381.741 416.2988,1381.4712 Q416.8923,1381.2015 417.5231,1380.6204 Z " fill="#000000"/><text fill="#000000" font-family="sarabun" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="45" x="442.45" y="1374.416">«Utility»</text><text fill="#000000" font-family="sarabun" font-size="12" lengthAdjust="spacing" textLength="70" x="429.95" y="1390.016">DataExporter</text><line style="stroke:#000000;stroke-width:1.5;" x1="397" x2="506" y1="1397.8" y2="1397.8"/><line style="stroke:#000000;stroke-width:1.5;" x1="397" x2="506" y1="1405.8" y2="1405.8"/><ellipse cx="407" cy="1416.8" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="85" x="416" y="1421.548">exportJSON(data)</text><ellipse cx="407" cy="1431.1" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="11" lengthAdjust="spacing" textLength="78" x="416" y="1435.848">exportCSV(data)</text><path d="M6,6 L6,185 L278,185 L278,16 L268,6 L6,6 " fill="#FBFB77" filter="url(#fc61ddkkbk4fr)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M268,6 L268,16 L278,16 L268,6 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sarabun" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="145" x="12" y="24.884">TaijiFlow AI Architecture</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="0" x="15" y="41.784"/><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="172" x="12" y="58.684">MVC-like Pattern (5 Packages):</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="4" x="12" y="75.584">-</text><text fill="#000000" font-family="sarabun" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="67" x="19" y="75.584">Controllers</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="170" x="86" y="75.584">: script.js + Keyboard + Display</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="4" x="12" y="92.484">-</text><text fill="#000000" font-family="sarabun" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="19" y="92.484">Core</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="216" x="47" y="92.484">: HeuristicsEngine, Calibration, Scoring</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="4" x="12" y="109.384">-</text><text fill="#000000" font-family="sarabun" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="43" x="19" y="109.384">Display</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="155" x="62" y="109.384">: Drawing, Ghost, Silhouette</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="4" x="12" y="126.284">-</text><text fill="#000000" font-family="sarabun" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="13" x="19" y="126.284">UI</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="123" x="32" y="126.284">: UIManager + 6 more</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="4" x="12" y="143.184">-</text><text fill="#000000" font-family="sarabun" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="38" x="19" y="143.184">Utility</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="134" x="57" y="143.184">: Session, Path, Exporter</text><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="0" x="15" y="160.084"/><text fill="#000000" font-family="sarabun" font-size="13" lengthAdjust="spacing" textLength="164" x="12" y="176.984">Total: 18 Classes, 21 Modules</text><!--MD5=[32b2559013a2af7d3fbb88a153276af5]
link DrawingManager to GhostManager--><!--MD5=[8bc32212dad9a8717d16c822af8c8827]
link GhostManager to SilhouetteManager--><!--MD5=[51eaa1b43a149febd10d66dbba0f63b6]
link UIManager to AudioManager--><!--MD5=[206c125da6c0fa549c2eb92f359766ca]
link AudioManager to TutorialManager--><!--MD5=[a0969e0435b22411c39d04728eb08a32]
link TutorialManager to ScorePopupManager--><!--MD5=[17a773bcde99f8f6aad6ef435d752061]
link ScorePopupManager to RulesConfigManager--><!--MD5=[78b5e27333e049fa5626f7341eb605de]
link RulesConfigManager to GestureManager--><!--MD5=[ec4871536f25f262224859d313d60b14]
link GestureManager to FeedbackManager--><!--MD5=[8ecf8a2be7bc1144d736fe69cb3dc5d0]
link SessionManager to PathGenerator--><!--MD5=[b4153a4765cd3212441a027f5c92dbfd]
link PathGenerator to DataExporter--><!--MD5=[bf3c87166e1461fb0037a62116064262]
link Script to KeyboardController--><path codeLine="279" d="M234.44,428.83 C234.44,428.83 377.1,428.83 377.1,428.83 " fill="none" id="Script-to-KeyboardController" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="382.1,428.82,373.1,424.82,377.1,428.82,373.1,432.82,382.1,428.82" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[066c35afdd785367532baf5480047ad9]
link Script to DisplayController--><path codeLine="280" d="M234.21,495.85 C234.21,495.85 618.33,495.85 618.33,495.85 " fill="none" id="Script-to-DisplayController" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="623.33,495.85,614.33,491.85,618.33,495.85,614.33,499.85,623.33,495.85" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[bb640fb10fb5d2929dca8b96a4ce4b2e]
link Script to HeuristicsEngine--><path codeLine="281" d="M234.21,529.29 C496.67,529.29 1229,529.29 1229,529.29 C1229,529.29 1229,1052.63 1229,1052.63 " fill="none" id="Script-to-HeuristicsEngine" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="1229,1057.63,1233,1048.63,1229,1052.63,1225,1048.63,1229,1057.63" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[df44e9dcfa25f6d6d0ebc55302acba7f]
link Script to CalibrationManager--><path codeLine="282" d="M234.34,523.52 C528.75,523.52 1426,523.52 1426,523.52 C1426,523.52 1426,1069.2 1426,1069.2 " fill="none" id="Script-to-CalibrationManager" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="1426,1074.2,1430,1065.2,1426,1069.2,1422,1065.2,1426,1074.2" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[e96b2d5337d6cc8c6fa37ff8fa78d55e]
link Script to DrawingManager--><path codeLine="283" d="M234.22,535.06 C431.98,535.06 879,535.06 879,535.06 C879,535.06 879,723.76 879,723.76 " fill="none" id="Script-to-DrawingManager" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="879,728.76,883,719.76,879,723.76,875,719.76,879,728.76" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[6fbfb2b36488141d6f4cc532d3959812]
link Script to UIManager--><path codeLine="284" d="M160,555.5 C160,734.89 160,1132.5 160,1132.5 C160,1132.5 373.3,1132.5 373.3,1132.5 " fill="none" id="Script-to-UIManager" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="378.3,1132.5,369.3,1128.5,373.3,1132.5,369.3,1136.5,378.3,1132.5" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[1b30a48cdca0eca6112e471747dd5049]
link Script to AudioManager--><path codeLine="285" d="M234.22,553.56 C298.21,553.56 372,553.56 372,553.56 C372,553.56 372,860.76 372,860.76 " fill="none" id="Script-to-AudioManager" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="372,865.76,376,856.76,372,860.76,368,856.76,372,865.76" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[d3159cad506f0cb1a1310c2a9273c5ba]
link Script to TutorialManager--><path codeLine="286" d="M234.17,551.82 C325.55,551.82 452,551.82 452,551.82 C452,551.82 452,720.26 452,720.26 " fill="none" id="Script-to-TutorialManager" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="452,725.26,456,716.26,452,720.26,448,716.26,452,725.26" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[c9d5948225815dc913d981d595174205]
link Script to GestureManager--><path codeLine="287" d="M234.21,550.08 C395.06,550.08 710,550.08 710,550.08 C710,550.08 710,707.29 710,707.29 " fill="none" id="Script-to-GestureManager" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="710,712.29,714,703.29,710,707.29,706,703.29,710,712.29" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[054d7b1fdba22383893cfa838083967a]
link DisplayController to GhostManager--><path codeLine="290" d="M795.15,386.5 C795.15,386.5 878.42,386.5 878.42,386.5 " fill="none" id="DisplayController-to-GhostManager" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="883.42,386.5,874.42,382.5,878.42,386.5,874.42,390.5,883.42,386.5" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[1846a93d7a5701a9b0bddea8ba6ba875]
link DisplayController to SilhouetteManager--><path codeLine="291" d="M785,517.9 C785,535.89 785,548.34 785,548.34 C785,548.34 880.63,548.34 880.63,548.34 " fill="none" id="DisplayController-to-SilhouetteManager" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="885.63,548.34,876.63,544.34,880.63,548.34,876.63,552.34,885.63,548.34" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[114b1c542304188696707e3b7725b454]
link KeyboardController to DisplayController--><path codeLine="292" d="M519.42,428.5 C519.42,428.5 618.44,428.5 618.44,428.5 " fill="none" id="KeyboardController-to-DisplayController" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#000000" points="623.44,428.5,614.44,424.5,618.44,428.5,614.44,432.5,623.44,428.5" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[93c85ec313925d227df23d58d1ea3cf5]
link HeuristicsEngine to CalibrationManager--><path codeLine="295" d="M1318.49,1164.5 C1318.49,1164.5 1351.17,1164.5 1351.17,1164.5 " fill="none" id="HeuristicsEngine-to-CalibrationManager" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#000000" points="1356.17,1164.5,1347.17,1160.5,1351.17,1164.5,1347.17,1168.5,1356.17,1164.5" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[f54eabe09eee0fd5b70ad09dfcf80d76]
reverse link ScoringManager to HeuristicsEngine--><path codeLine="296" d="M1065.97,1184.5 C1065.97,1184.5 1140.68,1184.5 1140.68,1184.5 " fill="none" id="ScoringManager-backto-HeuristicsEngine" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#000000" points="1060.97,1184.5,1069.97,1188.5,1065.97,1184.5,1069.97,1180.5,1060.97,1184.5" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[8130cbae6e915c6bd816ad1177fd8668]
reverse link DrawingManager to HeuristicsEngine--><path codeLine="297" d="M1080,971.33 C1080,971.33 1080,1068.55 1080,1068.55 C1080,1068.55 1108.62,1068.55 1140.81,1068.55 " fill="none" id="DrawingManager-backto-HeuristicsEngine" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#000000" points="1080,966.33,1076,975.33,1080,971.33,1084,975.33,1080,966.33" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[21cbf8643b8569618ababa145af3b81c]
link UIManager to ScorePopupManager--><path codeLine="300" d="M523.16,1188.2 C523.16,1188.2 632.58,1188.2 632.58,1188.2 " fill="none" id="UIManager-to-ScorePopupManager" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="637.58,1188.2,628.58,1184.2,632.58,1188.2,628.58,1192.2,637.58,1188.2" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[6cc97f7bc7c31b26f16b0bdedb965ee3]
link ScoringManager to ScorePopupManager--><path codeLine="301" d="M915.68,1175.5 C915.68,1175.5 787.08,1175.5 787.08,1175.5 " fill="none" id="ScoringManager-to-ScorePopupManager" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#000000" points="782.08,1175.5,791.08,1179.5,787.08,1175.5,791.08,1171.5,782.08,1175.5" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[fefc158ffacc74b4ea6c698976d9bb28]
link Script to FeedbackManager--><path codeLine="302" d="M197,555.47 C197,670.79 197,861.25 197,861.25 C197,861.25 639.03,861.25 639.03,861.25 " fill="none" id="Script-to-FeedbackManager" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="644.03,861.25,635.03,857.25,639.03,861.25,635.03,865.25,644.03,861.25" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[9b185d876e8dca1007bb9a7007ca0ac2]
link RulesConfigManager to HeuristicsEngine--><path codeLine="303" d="M794.33,1077.68 C794.33,1077.68 1134.38,1077.68 1134.38,1077.68 " fill="none" id="RulesConfigManager-to-HeuristicsEngine" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="1139.38,1077.67,1130.38,1073.67,1134.38,1077.67,1130.38,1081.67,1139.38,1077.67" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[e978cfe7b79b9a9eecbc1f12c7812525]
link Script to SessionManager--><path codeLine="306" d="M87,555.42 C87,828.31 87,1657.5 87,1657.5 C87,1657.5 383.57,1657.5 383.57,1657.5 " fill="none" id="Script-to-SessionManager" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#000000" points="388.57,1657.5,379.57,1653.5,383.57,1657.5,379.57,1661.5,388.57,1657.5" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[a0e975fe68959f3d5f45bfbb14c56c08]
link Script to PathGenerator--><path codeLine="307" d="M234.31,540.83 C288.72,540.83 347,540.83 347,540.83 C347,540.83 347,1485.96 347,1485.96 " fill="none" id="Script-to-PathGenerator" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#000000" points="347,1490.96,351,1481.96,347,1485.96,343,1481.96,347,1490.96" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[107d199cd8363bbd797a6879dcd0743d]
link Script to DataExporter--><path codeLine="308" d="M124,555.74 C124,786.29 124,1399.5 124,1399.5 C124,1399.5 389.06,1399.5 389.06,1399.5 " fill="none" id="Script-to-DataExporter" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#000000" points="394.06,1399.5,385.06,1395.5,389.06,1399.5,385.06,1403.5,394.06,1399.5" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[fabce0306ec999bec1dda02b26d91a58]
@startuml TaijiFlow_Class_Diagram
' ============================================================================
' TaijiFlow AI - Class Diagram v1.2 (Updated: 2026-01-07)
' ============================================================================
' จัดกลุ่มด้วย Packages เพื่อความชัดเจน
' อ้างอิง: 21 JavaScript Modules
' ============================================================================

skinparam defaultFontName "sarabun"
skinparam packageStyle rectangle

' === Line Style Settings (ลดเส้นซ้อนทับ) ===
left to right direction
skinparam linetype ortho
skinparam nodesep 50
skinparam ranksep 40

skinparam class {
    BackgroundColor White
    BorderColor Black
    ArrowColor Black
}
skinparam package {
    BackgroundColor<<Controller>> #E3F2FD
    BackgroundColor<<Core>> #FFF3E0
    BackgroundColor<<Display>> #E0F7FA
    BackgroundColor<<UI>> #E8F5E9
    BackgroundColor<<Utility>> #F3E5F5
}

' ============================================================================
' CONTROLLERS PACKAGE
' ============================================================================

package "Controllers" <<Controller>> {
    class "script.js" as Script <<Main>> {
        - isTrainingMode: boolean
        - currentPerformanceMode: string
        - -
        + startTrainingFlow()
        + endTrainingSession()
        + onResults(results)
        + loadReferenceData()
        + setPerformanceMode(mode)
        + selectPerformanceMode(mode)
    }
    
    class KeyboardController {
        - deps: object
        - -
        + handleKeydown(event)
        + showShortcutsHelp()
    }
    
    class DisplayController {
        - showGhostOverlay: boolean
        - showPath: boolean
        - showSkeleton: boolean
        - showSilhouette: boolean
        - showTrail: boolean
        - showBlurBackground: boolean
        - trailHistory: array
        - -
        + init()
        + toggleInstructor(show)
        + resetToDefaults()
        + addTrailPoint(x, y)
        + clearTrail()
        + clearTrail()
        + initBlurBackgroundCheckbox()
        + autoDisableHighCostEffects()
    }
    
    note as NC
        **จัดการ Application Flow**
        Script = Main Controller
        Keyboard = 15 Shortcuts (เพิ่ม K)
        Display = 7 Options (เพิ่ม Blur)
    end note
}

' ============================================================================
' CORE MANAGERS PACKAGE
' ============================================================================

package "Core Managers" <<Core>> {
    class HeuristicsEngine {
        - config: object
        - calibrationData: object
        - -
        + analyze(landmarks): Feedback[]
        + setCalibration(data)
        - checkPathShape()
        - checkElbowSinking()
        - checkContinuity()
        - checkContinuity()
        - checkArmRotation()
        .. +4 more rules ..
    }
    
    class CalibrationManager {
        - isActive: boolean
        - calibrationData: object
        - level: string
        - -
        + start()
        + stop()
        + cancel()
        + process(landmarks)
        + setLevel(level)
        + drawOverlay(ctx)
    }
    
    class ScoringManager {
        - totalFrames: int
        - correctFrames: int
        - -
        + start()
        + recordFrame(feedbacks)
        + getSummary(): object
    }
}

' ============================================================================
' DISPLAY MANAGERS PACKAGE (แยกจาก Core เพราะเป็น View/Render)
' ============================================================================

package "Display Managers" <<Display>> {
    class DrawingManager {
        - ctx: CanvasRenderingContext2D
        - isMirrored: boolean
        - -
        + drawSkeleton(landmarks)
        + drawPath(path, color)
        + drawTrail(history)
        + drawFeedbackPanel(feedbacks)
        + drawDebugOverlay(debugInfo)
        + drawGhostSkeleton(landmarks)
        + drawSilhouetteVideo(video, opacity)
        + drawSilhouette(mask, color)
        + drawGestureFeedback(feedback)
        + drawCircularityIndicator(score)
        + drawBlurredBackground(ctx, image, mask)
    }
    
    class GhostManager {
        - isPlaying: boolean
        - opacity: number
        - silhouetteVideo: HTMLVideoElement
        - -
        + load(data)
        + loadSilhouetteVideo(url)
        + start()
        + stop()
        + update()
        + update()
        + getCurrentFrame()
        + setSpeed(speed)
        + setOpacity(opacity)
    }
    
    class SilhouetteManager {
        - isEnabled: boolean
        - color: string
        - -
        + enable()
        + disable()
        + toggle()
        + drawSilhouetteFromMask(ctx, mask)
    }
    
    ' Force horizontal layout
    DrawingManager -[hidden]right- GhostManager
    GhostManager -[hidden]right- SilhouetteManager
}

' ============================================================================
' UI MANAGERS PACKAGE
' ============================================================================

package "UI & Feedback" <<UI>> {
    together {
        class UIManager {
            - currentLang: string
            - currentTheme: string
            - -
            + toggleLanguage()
            + toggleTheme()
            + toggleLanguage()
            + toggleTheme()
            + showNotification(msg)
            + closeAllMenus(exceptId)
        }
        
        class AudioManager {
            - enabled: boolean
            - cooldown: number
            - -
            + speak(message)
            + speakFeedback(feedbacks)
            + waitForIdle(timeout)
            + getExerciseSpokenText(id, level)
        }
        
        class TutorialManager {
            - isOpen: boolean
            - -
            + open(lang)
            + close()
        }
        
        class ScorePopupManager {
            - -
            + show(summary, grade)
            + close()
        }
        
        class RulesConfigManager {
            - -
            + setRuleEnabled(key, enabled)
            + resetToDefaults()
        }
        
        class GestureManager {
            - isReady: boolean
            - -
            + init()
            + detectGestures(video)
        }
        
        class FeedbackManager {
            - formUrl: string
            - -
            + createButton()
            + showPopup()
            + getLang()
        }
    }
    
    ' Force horizontal layout
    UIManager -[hidden]right- AudioManager
    AudioManager -[hidden]right- TutorialManager
    TutorialManager -[hidden]right- ScorePopupManager
    ScorePopupManager -[hidden]right- RulesConfigManager
    RulesConfigManager -[hidden]right- GestureManager
    GestureManager -[hidden]right- FeedbackManager
}

' ============================================================================
' UTILITIES PACKAGE
' ============================================================================

package "Utilities" <<Utility>> {
    together {
        class SessionManager <<Utility>> {
            + getOrCreateUserId()
            + generateSessionId()
        }
        
        class PathGenerator <<Utility>> {
            + generateDynamicPath(landmarks, exercise)
        }
        
        class DataExporter <<Utility>> {
            + exportJSON(data)
            + exportCSV(data)
        }
    }
    
    ' Force horizontal layout
    SessionManager -[hidden]right- PathGenerator
    PathGenerator -[hidden]right- DataExporter
}

' ============================================================================
' RELATIONSHIPS (Simplified - ไม่มี label เพื่อความสะอาด)
' ============================================================================

' Controller relationships
Script - -> KeyboardController
Script - -> DisplayController
Script - -> HeuristicsEngine
Script - -> CalibrationManager
Script - -> DrawingManager
Script - -> UIManager
Script - -> AudioManager
Script - -> TutorialManager
Script - -> GestureManager

' Display Controller
DisplayController - -> GhostManager
DisplayController - -> SilhouetteManager
KeyboardController ..> DisplayController

' Core relationships
HeuristicsEngine ..> CalibrationManager
ScoringManager <.. HeuristicsEngine
DrawingManager <.. HeuristicsEngine

' UI relationships
UIManager - -> ScorePopupManager
ScoringManager .[norank].> ScorePopupManager
Script - -> FeedbackManager
RulesConfigManager - -> HeuristicsEngine

' Utilities (เส้นประ = indirect)
Script ..> SessionManager
Script ..> PathGenerator
Script ..> DataExporter

' ============================================================================
' ARCHITECTURE NOTE
' ============================================================================

note as N1
    **TaijiFlow AI Architecture**
    
    MVC-like Pattern (5 Packages):
    - **Controllers**: script.js + Keyboard + Display
    - **Core**: HeuristicsEngine, Calibration, Scoring
    - **Display**: Drawing, Ghost, Silhouette
    - **UI**: UIManager + 6 more
    - **Utility**: Session, Path, Exporter
    
    Total: 18 Classes, 21 Modules
end note

@enduml

@startuml TaijiFlow_Class_Diagram

skinparam defaultFontName "sarabun"
skinparam packageStyle rectangle

left to right direction
skinparam linetype ortho
skinparam nodesep 50
skinparam ranksep 40

skinparam class {
    BackgroundColor White
    BorderColor Black
    ArrowColor Black
}
skinparam package {
    BackgroundColor<<Controller>> #E3F2FD
    BackgroundColor<<Core>> #FFF3E0
    BackgroundColor<<Display>> #E0F7FA
    BackgroundColor<<UI>> #E8F5E9
    BackgroundColor<<Utility>> #F3E5F5
}


package "Controllers" <<Controller>> {
    class "script.js" as Script <<Main>> {
        - isTrainingMode: boolean
        - currentPerformanceMode: string
        - -
        + startTrainingFlow()
        + endTrainingSession()
        + onResults(results)
        + loadReferenceData()
        + setPerformanceMode(mode)
        + selectPerformanceMode(mode)
    }
    
    class KeyboardController {
        - deps: object
        - -
        + handleKeydown(event)
        + showShortcutsHelp()
    }
    
    class DisplayController {
        - showGhostOverlay: boolean
        - showPath: boolean
        - showSkeleton: boolean
        - showSilhouette: boolean
        - showTrail: boolean
        - showBlurBackground: boolean
        - trailHistory: array
        - -
        + init()
        + toggleInstructor(show)
        + resetToDefaults()
        + addTrailPoint(x, y)
        + clearTrail()
        + clearTrail()
        + initBlurBackgroundCheckbox()
        + autoDisableHighCostEffects()
    }
    
    note as NC
        **จัดการ Application Flow**
        Script = Main Controller
        Keyboard = 15 Shortcuts (เพิ่ม K)
        Display = 7 Options (เพิ่ม Blur)
    end note
}


package "Core Managers" <<Core>> {
    class HeuristicsEngine {
        - config: object
        - calibrationData: object
        - -
        + analyze(landmarks): Feedback[]
        + setCalibration(data)
        - checkPathShape()
        - checkElbowSinking()
        - checkContinuity()
        - checkContinuity()
        - checkArmRotation()
        .. +4 more rules ..
    }
    
    class CalibrationManager {
        - isActive: boolean
        - calibrationData: object
        - level: string
        - -
        + start()
        + stop()
        + cancel()
        + process(landmarks)
        + setLevel(level)
        + drawOverlay(ctx)
    }
    
    class ScoringManager {
        - totalFrames: int
        - correctFrames: int
        - -
        + start()
        + recordFrame(feedbacks)
        + getSummary(): object
    }
}


package "Display Managers" <<Display>> {
    class DrawingManager {
        - ctx: CanvasRenderingContext2D
        - isMirrored: boolean
        - -
        + drawSkeleton(landmarks)
        + drawPath(path, color)
        + drawTrail(history)
        + drawFeedbackPanel(feedbacks)
        + drawDebugOverlay(debugInfo)
        + drawGhostSkeleton(landmarks)
        + drawSilhouetteVideo(video, opacity)
        + drawSilhouette(mask, color)
        + drawGestureFeedback(feedback)
        + drawCircularityIndicator(score)
        + drawBlurredBackground(ctx, image, mask)
    }
    
    class GhostManager {
        - isPlaying: boolean
        - opacity: number
        - silhouetteVideo: HTMLVideoElement
        - -
        + load(data)
        + loadSilhouetteVideo(url)
        + start()
        + stop()
        + update()
        + update()
        + getCurrentFrame()
        + setSpeed(speed)
        + setOpacity(opacity)
    }
    
    class SilhouetteManager {
        - isEnabled: boolean
        - color: string
        - -
        + enable()
        + disable()
        + toggle()
        + drawSilhouetteFromMask(ctx, mask)
    }
    
    DrawingManager -[hidden]right- GhostManager
    GhostManager -[hidden]right- SilhouetteManager
}


package "UI & Feedback" <<UI>> {
    together {
        class UIManager {
            - currentLang: string
            - currentTheme: string
            - -
            + toggleLanguage()
            + toggleTheme()
            + toggleLanguage()
            + toggleTheme()
            + showNotification(msg)
            + closeAllMenus(exceptId)
        }
        
        class AudioManager {
            - enabled: boolean
            - cooldown: number
            - -
            + speak(message)
            + speakFeedback(feedbacks)
            + waitForIdle(timeout)
            + getExerciseSpokenText(id, level)
        }
        
        class TutorialManager {
            - isOpen: boolean
            - -
            + open(lang)
            + close()
        }
        
        class ScorePopupManager {
            - -
            + show(summary, grade)
            + close()
        }
        
        class RulesConfigManager {
            - -
            + setRuleEnabled(key, enabled)
            + resetToDefaults()
        }
        
        class GestureManager {
            - isReady: boolean
            - -
            + init()
            + detectGestures(video)
        }
        
        class FeedbackManager {
            - formUrl: string
            - -
            + createButton()
            + showPopup()
            + getLang()
        }
    }
    
    UIManager -[hidden]right- AudioManager
    AudioManager -[hidden]right- TutorialManager
    TutorialManager -[hidden]right- ScorePopupManager
    ScorePopupManager -[hidden]right- RulesConfigManager
    RulesConfigManager -[hidden]right- GestureManager
    GestureManager -[hidden]right- FeedbackManager
}


package "Utilities" <<Utility>> {
    together {
        class SessionManager <<Utility>> {
            + getOrCreateUserId()
            + generateSessionId()
        }
        
        class PathGenerator <<Utility>> {
            + generateDynamicPath(landmarks, exercise)
        }
        
        class DataExporter <<Utility>> {
            + exportJSON(data)
            + exportCSV(data)
        }
    }
    
    SessionManager -[hidden]right- PathGenerator
    PathGenerator -[hidden]right- DataExporter
}


Script - -> KeyboardController
Script - -> DisplayController
Script - -> HeuristicsEngine
Script - -> CalibrationManager
Script - -> DrawingManager
Script - -> UIManager
Script - -> AudioManager
Script - -> TutorialManager
Script - -> GestureManager

DisplayController - -> GhostManager
DisplayController - -> SilhouetteManager
KeyboardController ..> DisplayController

HeuristicsEngine ..> CalibrationManager
ScoringManager <.. HeuristicsEngine
DrawingManager <.. HeuristicsEngine

UIManager - -> ScorePopupManager
ScoringManager .[norank].> ScorePopupManager
Script - -> FeedbackManager
RulesConfigManager - -> HeuristicsEngine

Script ..> SessionManager
Script ..> PathGenerator
Script ..> DataExporter


note as N1
    **TaijiFlow AI Architecture**
    
    MVC-like Pattern (5 Packages):
    - **Controllers**: script.js + Keyboard + Display
    - **Core**: HeuristicsEngine, Calibration, Scoring
    - **Display**: Drawing, Ghost, Silhouette
    - **UI**: UIManager + 6 more
    - **Utility**: Session, Path, Exporter
    
    Total: 18 Classes, 21 Modules
end note

@enduml

PlantUML version 1.2021.00(Sun Jan 10 17:25:05 ICT 2021)
(MIT source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>