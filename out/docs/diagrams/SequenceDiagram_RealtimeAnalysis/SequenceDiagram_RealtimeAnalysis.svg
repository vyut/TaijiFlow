<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1249px" preserveAspectRatio="none" style="width:905px;height:1249px;background:#00000000;" version="1.1" viewBox="0 0 905 1249" width="905px" zoomAndPan="magnify"><defs><filter height="300%" id="fxf1vrxekjlzp" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fxf1vrxekjlzp)" height="1050.2" style="stroke:#A80036;stroke-width:1.0;" width="10" x="195" y="119.2"/><rect fill="#FFFFFF" filter="url(#fxf1vrxekjlzp)" height="382.1" style="stroke:#A80036;stroke-width:1.0;" width="10" x="375" y="479.1"/><rect fill="#FFFFFF" filter="url(#fxf1vrxekjlzp)" height="1092" style="stroke:#000000;stroke-width:2.0;" width="881" x="10" y="77.4"/><rect fill="#FFFFFF" filter="url(#fxf1vrxekjlzp)" height="910.5" style="stroke:#000000;stroke-width:2.0;" width="861" x="20" y="178.1"/><rect fill="#FFFFFF" filter="url(#fxf1vrxekjlzp)" height="157.5" style="stroke:#000000;stroke-width:2.0;" width="611.5" x="143" y="265.8"/><rect fill="#FFFFFF" filter="url(#fxf1vrxekjlzp)" height="80.7" style="stroke:#000000;stroke-width:2.0;" width="591.5" x="153" y="335.6"/><rect fill="#FFF3E0" filter="url(#fxf1vrxekjlzp)" height="431.9" style="stroke:#000000;stroke-width:2.0;" width="539" x="153" y="437.3"/><rect fill="#FFF3E0" filter="url(#fxf1vrxekjlzp)" height="93.7" style="stroke:#000000;stroke-width:2.0;" width="440.5" x="153" y="883.2"/><rect fill="#FFFFFF" filter="url(#fxf1vrxekjlzp)" height="90.7" style="stroke:#000000;stroke-width:2.0;" width="718" x="153" y="990.9"/><rect fill="#E0F7FA" filter="url(#fxf1vrxekjlzp)" height="59.8" style="stroke:#000000;stroke-width:2.0;" width="612.5" x="153" y="1102.6"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="70" x2="70" y1="60.4" y2="1186.4"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="200" x2="200" y1="60.4" y2="1186.4"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="379.5" x2="379.5" y1="60.4" y2="1186.4"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="548.5" x2="548.5" y1="60.4" y2="1186.4"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="631.5" x2="631.5" y1="60.4" y2="1186.4"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="706.5" x2="706.5" y1="60.4" y2="1186.4"/><rect fill="#E8F5E9" filter="url(#fxf1vrxekjlzp)" height="50.4" style="stroke:#A80036;stroke-width:1.5;" width="76" x="30" y="5"/><text fill="#000000" font-family="Sarabun" font-size="14" lengthAdjust="spacing" textLength="62" x="37" y="26.952">MediaPipe</text><text fill="#000000" font-family="Sarabun" font-size="14" lengthAdjust="spacing" textLength="29" x="53.5" y="45.152">Pose</text><rect fill="#E8F5E9" filter="url(#fxf1vrxekjlzp)" height="50.4" style="stroke:#A80036;stroke-width:1.5;" width="76" x="30" y="1185.4"/><text fill="#000000" font-family="Sarabun" font-size="14" lengthAdjust="spacing" textLength="62" x="37" y="1207.352">MediaPipe</text><text fill="#000000" font-family="Sarabun" font-size="14" lengthAdjust="spacing" textLength="29" x="53.5" y="1225.552">Pose</text><rect fill="#E3F2FD" filter="url(#fxf1vrxekjlzp)" height="32.2" style="stroke:#A80036;stroke-width:1.5;" width="70" x="163" y="23.2"/><text fill="#000000" font-family="Sarabun" font-size="14" lengthAdjust="spacing" textLength="50" x="173" y="45.152">Training</text><rect fill="#E3F2FD" filter="url(#fxf1vrxekjlzp)" height="32.2" style="stroke:#A80036;stroke-width:1.5;" width="70" x="163" y="1185.4"/><text fill="#000000" font-family="Sarabun" font-size="14" lengthAdjust="spacing" textLength="50" x="173" y="1207.352">Training</text><rect fill="#FFF3E0" filter="url(#fxf1vrxekjlzp)" height="32.2" style="stroke:#A80036;stroke-width:1.5;" width="73" x="341.5" y="23.2"/><text fill="#000000" font-family="Sarabun" font-size="14" lengthAdjust="spacing" textLength="59" x="348.5" y="45.152">Heuristics</text><rect fill="#FFF3E0" filter="url(#fxf1vrxekjlzp)" height="32.2" style="stroke:#A80036;stroke-width:1.5;" width="73" x="341.5" y="1185.4"/><text fill="#000000" font-family="Sarabun" font-size="14" lengthAdjust="spacing" textLength="59" x="348.5" y="1207.352">Heuristics</text><rect fill="#FFF3E0" filter="url(#fxf1vrxekjlzp)" height="32.2" style="stroke:#A80036;stroke-width:1.5;" width="65" x="514.5" y="23.2"/><text fill="#000000" font-family="Sarabun" font-size="14" lengthAdjust="spacing" textLength="39" x="527.5" y="45.152">Scorer</text><rect fill="#FFF3E0" filter="url(#fxf1vrxekjlzp)" height="32.2" style="stroke:#A80036;stroke-width:1.5;" width="65" x="514.5" y="1185.4"/><text fill="#000000" font-family="Sarabun" font-size="14" lengthAdjust="spacing" textLength="39" x="527.5" y="1207.352">Scorer</text><rect fill="#E0F7FA" filter="url(#fxf1vrxekjlzp)" height="32.2" style="stroke:#A80036;stroke-width:1.5;" width="72" x="593.5" y="23.2"/><text fill="#000000" font-family="Sarabun" font-size="14" lengthAdjust="spacing" textLength="49" x="606.5" y="45.152">Drawing</text><rect fill="#E0F7FA" filter="url(#fxf1vrxekjlzp)" height="32.2" style="stroke:#A80036;stroke-width:1.5;" width="72" x="593.5" y="1185.4"/><text fill="#000000" font-family="Sarabun" font-size="14" lengthAdjust="spacing" textLength="49" x="606.5" y="1207.352">Drawing</text><rect fill="#E8F5E9" filter="url(#fxf1vrxekjlzp)" height="32.2" style="stroke:#A80036;stroke-width:1.5;" width="51" x="679.5" y="23.2"/><text fill="#000000" font-family="Sarabun" font-size="14" lengthAdjust="spacing" textLength="13" x="698.5" y="45.152">UI</text><rect fill="#E8F5E9" filter="url(#fxf1vrxekjlzp)" height="32.2" style="stroke:#A80036;stroke-width:1.5;" width="51" x="679.5" y="1185.4"/><text fill="#000000" font-family="Sarabun" font-size="14" lengthAdjust="spacing" textLength="13" x="698.5" y="1207.352">UI</text><rect fill="#FFFFFF" filter="url(#fxf1vrxekjlzp)" height="1050.2" style="stroke:#A80036;stroke-width:1.0;" width="10" x="195" y="119.2"/><rect fill="#FFFFFF" filter="url(#fxf1vrxekjlzp)" height="382.1" style="stroke:#A80036;stroke-width:1.0;" width="10" x="375" y="479.1"/><path d="M10,77.4 L82,77.4 L82,85.4 L72,95.4 L10,95.4 L10,77.4 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="1092" style="stroke:#000000;stroke-width:2.0;" width="881" x="10" y="77.4"/><text fill="#000000" font-family="Sarabun" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="27" x="25" y="92.284">loop</text><text fill="#000000" font-family="Sarabun" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="175" x="97" y="91.148">[Camera Loop: ทุก Frame (~30 fps)]</text><polygon fill="#A80036" points="183,115.2,193,119.2,183,123.2,187,119.2" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="70" x2="189" y1="119.2" y2="119.2"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="89" x="88" y="114.184">onFrame(video)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="205" x2="247" y1="150.1" y2="150.1"/><line style="stroke:#A80036;stroke-width:1.0;" x1="247" x2="247" y1="150.1" y2="163.1"/><line style="stroke:#A80036;stroke-width:1.0;" x1="206" x2="247" y1="163.1" y2="163.1"/><polygon fill="#A80036" points="216,159.1,206,163.1,216,167.1,212,163.1" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="144" x="212" y="145.084">throttleFrameCounter++</text><path d="M20,178.1 L85,178.1 L85,186.1 L75,196.1 L20,196.1 L20,178.1 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="910.5" style="stroke:#000000;stroke-width:2.0;" width="861" x="20" y="178.1"/><text fill="#000000" font-family="Sarabun" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20" x="35" y="192.984">opt</text><text fill="#000000" font-family="Sarabun" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="215" x="100" y="191.848">[Process Frame (Every 4th Frame ~7.5 fps)]</text><polygon fill="#A80036" points="81,215.9,71,219.9,81,223.9,77,219.9" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="75" x2="194" y1="219.9" y2="219.9"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="93" x="86" y="214.884">pose.send(video)</text><polygon fill="#A80036" points="183,246.8,193,250.8,183,254.8,187,250.8" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="70" x2="189" y1="250.8" y2="250.8"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="101" x="82" y="245.784">onResults(results)</text><path d="M143,265.8 L208,265.8 L208,273.8 L198,283.8 L143,283.8 L143,265.8 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="157.5" style="stroke:#000000;stroke-width:2.0;" width="611.5" x="143" y="265.8"/><text fill="#000000" font-family="Sarabun" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20" x="158" y="280.684">opt</text><text fill="#000000" font-family="Sarabun" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="113" x="223" y="279.548">[Environmental Check]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="205" x2="247" y1="307.6" y2="307.6"/><line style="stroke:#A80036;stroke-width:1.0;" x1="247" x2="247" y1="307.6" y2="320.6"/><line style="stroke:#A80036;stroke-width:1.0;" x1="206" x2="247" y1="320.6" y2="320.6"/><polygon fill="#A80036" points="216,316.6,206,320.6,216,324.6,212,320.6" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="108" x="212" y="302.584">checkAvgVisibility()</text><path d="M153,335.6 L214,335.6 L214,343.6 L204,353.6 L153,353.6 L153,335.6 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="80.7" style="stroke:#000000;stroke-width:2.0;" width="591.5" x="153" y="335.6"/><text fill="#000000" font-family="Sarabun" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="168" y="350.484">alt</text><text fill="#000000" font-family="Sarabun" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="139" x="229" y="349.348">[visibility &lt; 0.5 (Low Light)]</text><polygon fill="#A80036" points="695,373.4,705,377.4,695,381.4,699,377.4" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="205" x2="701" y1="377.4" y2="377.4"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="157" x="377.5" y="372.384">showNotification("แสงน้อย")</text><polygon fill="#A80036" points="695,404.3,705,408.3,695,412.3,699,408.3" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="205" x2="701" y1="408.3" y2="408.3"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="124" x="394" y="403.284">audioManager.speak()</text><path d="M153,437.3 L300,437.3 L300,445.3 L290,455.3 L153,455.3 L153,437.3 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="431.9" style="stroke:#000000;stroke-width:2.0;" width="539" x="153" y="437.3"/><text fill="#000000" font-family="Sarabun" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="168" y="452.184">วิเคราะห์ท่า (8 กฎ)</text><polygon fill="#A80036" points="363,475.1,373,479.1,363,483.1,367,479.1" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="205" x2="369" y1="479.1" y2="479.1"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="111" x="234.5" y="474.084">analyze(landmarks)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="385" x2="427" y1="510" y2="510"/><line style="stroke:#A80036;stroke-width:1.0;" x1="427" x2="427" y1="510" y2="523"/><line style="stroke:#A80036;stroke-width:1.0;" x1="386" x2="427" y1="523" y2="523"/><polygon fill="#A80036" points="396,519,386,523,396,527,392,523" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="114" x="392" y="504.984">1. checkPathShape()</text><path d="M518,493.6 L518,519.6 L633,519.6 L633,503.6 L623,493.6 L518,493.6 " fill="#FBFB77" filter="url(#fxf1vrxekjlzp)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M623,493.6 L623,503.6 L633,503.6 L623,493.6 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="94" x="524" y="512.484">เส้นทางเป็นวงโค้ง</text><line style="stroke:#A80036;stroke-width:1.0;" x1="385" x2="427" y1="553.9" y2="553.9"/><line style="stroke:#A80036;stroke-width:1.0;" x1="427" x2="427" y1="553.9" y2="566.9"/><line style="stroke:#A80036;stroke-width:1.0;" x1="386" x2="427" y1="566.9" y2="566.9"/><polygon fill="#A80036" points="396,562.9,386,566.9,396,570.9,392,566.9" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="135" x="392" y="548.884">2. checkWaistInitiation()</text><path d="M539,537.5 L539,563.5 L668,563.5 L668,547.5 L658,537.5 L539,537.5 " fill="#FBFB77" filter="url(#fxf1vrxekjlzp)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M658,537.5 L658,547.5 L668,547.5 L658,537.5 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="108" x="545" y="556.384">เอวนำการเคลื่อนไหว</text><line style="stroke:#A80036;stroke-width:1.0;" x1="385" x2="427" y1="597.8" y2="597.8"/><line style="stroke:#A80036;stroke-width:1.0;" x1="427" x2="427" y1="597.8" y2="610.8"/><line style="stroke:#A80036;stroke-width:1.0;" x1="386" x2="427" y1="610.8" y2="610.8"/><polygon fill="#A80036" points="396,606.8,386,610.8,396,614.8,392,610.8" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="119" x="392" y="592.784">3. checkWeightShift()</text><path d="M523,581.4 L523,607.4 L634,607.4 L634,591.4 L624,581.4 L523,581.4 " fill="#FBFB77" filter="url(#fxf1vrxekjlzp)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M624,581.4 L624,591.4 L634,591.4 L624,581.4 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="90" x="529" y="600.284">ถ่ายน้ำหนักสมดุล</text><line style="stroke:#A80036;stroke-width:1.0;" x1="385" x2="427" y1="641.7" y2="641.7"/><line style="stroke:#A80036;stroke-width:1.0;" x1="427" x2="427" y1="641.7" y2="654.7"/><line style="stroke:#A80036;stroke-width:1.0;" x1="386" x2="427" y1="654.7" y2="654.7"/><polygon fill="#A80036" points="396,650.7,386,654.7,396,658.7,392,654.7" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="145" x="392" y="636.684">4. checkVerticalStability()</text><path d="M549,625.3 L549,651.3 L649,651.3 L649,635.3 L639,625.3 L549,625.3 " fill="#FBFB77" filter="url(#fxf1vrxekjlzp)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M639,625.3 L639,635.3 L649,635.3 L639,625.3 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="79" x="555" y="644.184">ศีรษะนิ่ง ไม่โยก</text><line style="stroke:#A80036;stroke-width:1.0;" x1="385" x2="427" y1="685.6" y2="685.6"/><line style="stroke:#A80036;stroke-width:1.0;" x1="427" x2="427" y1="685.6" y2="698.6"/><line style="stroke:#A80036;stroke-width:1.0;" x1="386" x2="427" y1="698.6" y2="698.6"/><polygon fill="#A80036" points="396,694.6,386,698.6,396,702.6,392,698.6" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="126" x="392" y="680.584">5. checkArmRotation()</text><path d="M530,669.2 L530,695.2 L637,695.2 L637,679.2 L627,669.2 L530,669.2 " fill="#FBFB77" filter="url(#fxf1vrxekjlzp)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M627,669.2 L627,679.2 L637,679.2 L627,669.2 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="86" x="536" y="688.084">หมุนฝ่ามือถูกทิศ</text><line style="stroke:#A80036;stroke-width:1.0;" x1="385" x2="427" y1="729.5" y2="729.5"/><line style="stroke:#A80036;stroke-width:1.0;" x1="427" x2="427" y1="729.5" y2="742.5"/><line style="stroke:#A80036;stroke-width:1.0;" x1="386" x2="427" y1="742.5" y2="742.5"/><polygon fill="#A80036" points="396,738.5,386,742.5,396,746.5,392,742.5" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="127" x="392" y="724.484">6. checkElbowSinking()</text><path d="M531,713.1 L531,739.1 L629,739.1 L629,723.1 L619,713.1 L531,713.1 " fill="#FBFB77" filter="url(#fxf1vrxekjlzp)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M619,713.1 L619,723.1 L629,723.1 L619,713.1 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="77" x="537" y="731.984">ศอกจม ไม่ลอย</text><line style="stroke:#A80036;stroke-width:1.0;" x1="385" x2="427" y1="773.4" y2="773.4"/><line style="stroke:#A80036;stroke-width:1.0;" x1="427" x2="427" y1="773.4" y2="786.4"/><line style="stroke:#A80036;stroke-width:1.0;" x1="386" x2="427" y1="786.4" y2="786.4"/><polygon fill="#A80036" points="396,782.4,386,786.4,396,790.4,392,786.4" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="121" x="392" y="768.384">7. checkSmoothness()</text><path d="M525,757 L525,783 L639,783 L639,767 L629,757 L525,757 " fill="#FBFB77" filter="url(#fxf1vrxekjlzp)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M629,757 L629,767 L639,767 L629,757 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="93" x="531" y="775.884">เคลื่อนไหวลื่นไหล</text><line style="stroke:#A80036;stroke-width:1.0;" x1="385" x2="427" y1="817.3" y2="817.3"/><line style="stroke:#A80036;stroke-width:1.0;" x1="427" x2="427" y1="817.3" y2="830.3"/><line style="stroke:#A80036;stroke-width:1.0;" x1="386" x2="427" y1="830.3" y2="830.3"/><polygon fill="#A80036" points="396,826.3,386,830.3,396,834.3,392,830.3" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="111" x="392" y="812.284">8. checkContinuity()</text><path d="M515,800.9 L515,826.9 L631,826.9 L631,810.9 L621,800.9 L515,800.9 " fill="#FBFB77" filter="url(#fxf1vrxekjlzp)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M621,800.9 L621,810.9 L631,810.9 L621,800.9 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="95" x="521" y="819.784">ต่อเนื่อง ไม่หยุดนิ่ง</text><polygon fill="#A80036" points="216,857.2,206,861.2,216,865.2,212,861.2" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="210" x2="379" y1="861.2" y2="861.2"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="64" x="260.5" y="856.184">feedbacks[]</text><path d="M153,883.2 L335,883.2 L335,891.2 L325,901.2 L153,901.2 L153,883.2 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="93.7" style="stroke:#000000;stroke-width:2.0;" width="440.5" x="153" y="883.2"/><text fill="#000000" font-family="Sarabun" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="137" x="168" y="898.084">บันทึกข้อมูล (Recording)</text><polygon fill="#A80036" points="537,921,547,925,537,929,541,925" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="205" x2="543" y1="925" y2="925"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="138" x="308" y="919.984">recordFrame(feedbacks)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="205" x2="247" y1="955.9" y2="955.9"/><line style="stroke:#A80036;stroke-width:1.0;" x1="247" x2="247" y1="955.9" y2="968.9"/><line style="stroke:#A80036;stroke-width:1.0;" x1="206" x2="247" y1="968.9" y2="968.9"/><polygon fill="#A80036" points="216,964.9,206,968.9,216,972.9,212,968.9" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="156" x="212" y="950.884">recordedSessionData.push()</text><path d="M153,990.9 L214,990.9 L214,998.9 L204,1008.9 L153,1008.9 L153,990.9 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="90.7" style="stroke:#000000;stroke-width:2.0;" width="718" x="153" y="990.9"/><text fill="#000000" font-family="Sarabun" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="168" y="1005.784">alt</text><text fill="#000000" font-family="Sarabun" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="85" x="229" y="1004.648">[มี feedback ใหม่]</text><polygon fill="#A80036" points="695,1033.7,705,1037.7,695,1041.7,699,1037.7" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="205" x2="701" y1="1037.7" y2="1037.7"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="146" x="383" y="1032.684">updateFeedbackOverlay()</text><path d="M712,1014.8 L712,1040.8 L852,1040.8 L852,1024.8 L842,1014.8 L712,1014.8 " fill="#FBFB77" filter="url(#fxf1vrxekjlzp)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M842,1014.8 L842,1024.8 L852,1024.8 L842,1014.8 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="119" x="718" y="1033.684">แสดงข้อความ (HTML)</text><polygon fill="#A80036" points="695,1069.6,705,1073.6,695,1077.6,699,1073.6" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="205" x2="701" y1="1073.6" y2="1073.6"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="178" x="367" y="1068.584">audioManager.speakFeedback()</text><path d="M153,1102.6 L372,1102.6 L372,1110.6 L362,1120.6 L153,1120.6 L153,1102.6 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="59.8" style="stroke:#000000;stroke-width:2.0;" width="612.5" x="153" y="1102.6"/><text fill="#000000" font-family="Sarabun" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="174" x="168" y="1117.484">วาดภาพ (Rendering @ 30 FPS)</text><polygon fill="#A80036" points="619.5,1145.4,629.5,1149.4,619.5,1153.4,623.5,1149.4" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="205" x2="625.5" y1="1149.4" y2="1149.4"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="208" x="314.25" y="1144.384">drawSkeleton / drawPath / drawTrail</text><path d="M636,1126.5 L636,1152.5 L746,1152.5 L746,1136.5 L736,1126.5 L636,1126.5 " fill="#FBFB77" filter="url(#fxf1vrxekjlzp)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M736,1126.5 L736,1136.5 L746,1136.5 L736,1126.5 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="Sarabun" font-size="13" lengthAdjust="spacing" textLength="89" x="642" y="1145.384">วาดทับบน Video</text><!--MD5=[261665df9e7ea83eba72a7e870d89965]
@startuml SequenceDiagram_RealtimeAnalysis
' ============================================================================
' TaijiFlow AI - Sequence Diagram: Real-time Pose Analysis
' ============================================================================
' แสดงการวิเคราะห์ท่าแบบ Real-time ในแต่ละ Frame
' อ้างอิง: onResults() callback ใน script.js (lines 1200-1470)
' ============================================================================

skinparam defaultFontName "Sarabun"
skinparam backgroundColor transparent
skinparam sequenceMessageAlign center

' === Participants ===
participant "MediaPipe\nPose" as MediaPipe #E8F5E9
participant " Training " as Training #E3F2FD
participant "Heuristics" as Heuristics #FFF3E0
participant "  Scorer  " as Scorer #FFF3E0
participant "  Drawing " as Drawing #E0F7FA
participant "    UI    " as UI #E8F5E9

' ============================================================================
' MAIN LOOP: onResults Callback
' ============================================================================

loop Camera Loop: ทุก Frame (~30 fps)
    MediaPipe -> Training : onFrame(video)
    activate Training
    
    Training -> Training : throttleFrameCounter++
    
    ' === Throttling Check ===
    opt Process Frame (Every 4th Frame ~7.5 fps)
        Training -> MediaPipe : pose.send(video)
        MediaPipe -> Training : onResults(results)
        
        ' === Environmental Check (Low Light) ===
        opt Environmental Check
            Training -> Training : checkAvgVisibility()
            alt visibility < 0.5 (Low Light)
                Training -> UI : showNotification("แสงน้อย")
                Training -> UI : audioManager.speak()
            end
        end

        ' === Step 1: Analyze Pose (8 Rules) ===
        group #FFF3E0 วิเคราะห์ท่า (8 กฎ)
            Training -> Heuristics : analyze(landmarks)
            activate Heuristics
            
            Heuristics -> Heuristics : 1. checkPathShape()
            note right: เส้นทางเป็นวงโค้ง
            
            Heuristics -> Heuristics : 2. checkWaistInitiation()
            note right: เอวนำการเคลื่อนไหว
            
            Heuristics -> Heuristics : 3. checkWeightShift()
            note right: ถ่ายน้ำหนักสมดุล
            
            Heuristics -> Heuristics : 4. checkVerticalStability()
            note right: ศีรษะนิ่ง ไม่โยก
            
            Heuristics -> Heuristics : 5. checkArmRotation()
            note right: หมุนฝ่ามือถูกทิศ
            
            Heuristics -> Heuristics : 6. checkElbowSinking()
            note right: ศอกจม ไม่ลอย
            
            Heuristics -> Heuristics : 7. checkSmoothness()
            note right: เคลื่อนไหวลื่นไหล
            
            Heuristics -> Heuristics : 8. checkContinuity()
            note right: ต่อเนื่อง ไม่หยุดนิ่ง
            
            Heuristics - -> Training : feedbacks[]
            deactivate Heuristics
        end
        
        ' === Step 2: Record Data ===
        group #FFF3E0 บันทึกข้อมูล (Recording)
            Training -> Scorer : recordFrame(feedbacks)
            Training -> Training : recordedSessionData.push()
        end
        
        ' === Step 4: Show Feedback ===
        alt มี feedback ใหม่
            Training -> UI : updateFeedbackOverlay()
            note right: แสดงข้อความ (HTML)
            Training -> UI : audioManager.speakFeedback()
        end
    end
    
    ' === Step 3: Draw Visuals (Every Frame 30 FPS) ===
    group #E0F7FA วาดภาพ (Rendering @ 30 FPS)
        Training -> Drawing : drawSkeleton / drawPath / drawTrail
        note right: วาดทับบน Video
    end
    
    deactivate Training
end

@enduml

@startuml SequenceDiagram_RealtimeAnalysis

skinparam defaultFontName "Sarabun"
skinparam backgroundColor transparent
skinparam sequenceMessageAlign center

participant "MediaPipe\nPose" as MediaPipe #E8F5E9
participant " Training " as Training #E3F2FD
participant "Heuristics" as Heuristics #FFF3E0
participant "  Scorer  " as Scorer #FFF3E0
participant "  Drawing " as Drawing #E0F7FA
participant "    UI    " as UI #E8F5E9


loop Camera Loop: ทุก Frame (~30 fps)
    MediaPipe -> Training : onFrame(video)
    activate Training
    
    Training -> Training : throttleFrameCounter++
    
    opt Process Frame (Every 4th Frame ~7.5 fps)
        Training -> MediaPipe : pose.send(video)
        MediaPipe -> Training : onResults(results)
        
        opt Environmental Check
            Training -> Training : checkAvgVisibility()
            alt visibility < 0.5 (Low Light)
                Training -> UI : showNotification("แสงน้อย")
                Training -> UI : audioManager.speak()
            end
        end

        group #FFF3E0 วิเคราะห์ท่า (8 กฎ)
            Training -> Heuristics : analyze(landmarks)
            activate Heuristics
            
            Heuristics -> Heuristics : 1. checkPathShape()
            note right: เส้นทางเป็นวงโค้ง
            
            Heuristics -> Heuristics : 2. checkWaistInitiation()
            note right: เอวนำการเคลื่อนไหว
            
            Heuristics -> Heuristics : 3. checkWeightShift()
            note right: ถ่ายน้ำหนักสมดุล
            
            Heuristics -> Heuristics : 4. checkVerticalStability()
            note right: ศีรษะนิ่ง ไม่โยก
            
            Heuristics -> Heuristics : 5. checkArmRotation()
            note right: หมุนฝ่ามือถูกทิศ
            
            Heuristics -> Heuristics : 6. checkElbowSinking()
            note right: ศอกจม ไม่ลอย
            
            Heuristics -> Heuristics : 7. checkSmoothness()
            note right: เคลื่อนไหวลื่นไหล
            
            Heuristics -> Heuristics : 8. checkContinuity()
            note right: ต่อเนื่อง ไม่หยุดนิ่ง
            
            Heuristics - -> Training : feedbacks[]
            deactivate Heuristics
        end
        
        group #FFF3E0 บันทึกข้อมูล (Recording)
            Training -> Scorer : recordFrame(feedbacks)
            Training -> Training : recordedSessionData.push()
        end
        
        alt มี feedback ใหม่
            Training -> UI : updateFeedbackOverlay()
            note right: แสดงข้อความ (HTML)
            Training -> UI : audioManager.speakFeedback()
        end
    end
    
    group #E0F7FA วาดภาพ (Rendering @ 30 FPS)
        Training -> Drawing : drawSkeleton / drawPath / drawTrail
        note right: วาดทับบน Video
    end
    
    deactivate Training
end

@enduml

PlantUML version 1.2021.00(Sun Jan 10 17:25:05 ICT 2021)
(MIT source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>